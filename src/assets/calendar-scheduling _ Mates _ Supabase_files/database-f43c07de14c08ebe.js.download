!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="898a0b0d-7be1-40a7-8335-29592a0c7134",e._sentryDebugIdIdentifier="sentry-dbid-898a0b0d-7be1-40a7-8335-29592a0c7134")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5323,8426],{6885:(e,t,a)=>{"use strict";a.d(t,{B:()=>l,p:()=>i});var r=a(66880),s=a(40281);let i=e=>Object.fromEntries(new URLSearchParams(e)),l=(e,t)=>Object.entries(e).reduce((e,a)=>{let[i,{sql:l,queryType:n}]=a;return"db"===n?{...e,[i]:()=>(0,r.A)({sql:l})}:{...e,[i]:()=>(0,s.A)(t)}},{})},10906:(e,t,a)=>{"use strict";a.d(t,{A:()=>p,U:()=>m});var r=a(80263),s=a(53434),i=a.n(s),l=a(62659),n=a(53239),o=a(64036),d=a(74115),c=a(71126),u=a(51859);let m=e=>{var t;let{onChange:a,value:s,options:m,className:p,loading:h,currentBillingPeriodStart:g,currentBillingPeriodEnd:f,footer:x}=e,[y,v]=(0,n.useState)(s);(0,n.useEffect)(()=>{A(s)},[h]);let b=i()().startOf("month").format(o.DX),_=i()().add(1,"month").startOf("month").format(o.DX),j=i()().format(o.DX);function A(e){switch(v(e),e){case"currentBillingCycle":a({period_start:{date:i().unix(null!=g?g:0).format(o.DX),time_period:"1d"},period_end:{date:i().unix(null!=f?f:0).format(o.DX),time_period:"today"},interval:"1d"});break;case"previousBillingCycle":a({period_start:{date:i().unix(null!=g?g:0).subtract(1,"month").format(o.DX),time_period:"1d"},period_end:{date:i().unix(null!=g?g:0).format(o.DX),time_period:"today"},interval:"1d"});break;case"10m":a({period_start:{date:i()().subtract(10,"minutes").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"30m":a({period_start:{date:i()().subtract(30,"minutes").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"1d":a({period_start:{date:i()().subtract(24,"hour").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1h"});break;case"3h":a({period_start:{date:i()().subtract(3,"hour").format(o.DX),time_period:"3h"},period_end:{date:j,time_period:"today"},interval:"5m"});break;case"1h":a({period_start:{date:i()().subtract(1,"hour").format(o.DX),time_period:"1h"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"7d":a({period_start:{date:i()().subtract(7,"day").format(o.DX),time_period:"7d"},period_end:{date:j,time_period:"today"},interval:"1d"});break;case"30d":a({period_start:{date:i()().subtract(30,"day").format(o.DX),time_period:"30d"},period_end:{date:j,time_period:"today"},interval:"1d"});break;case"60d":a({period_start:{date:i()().subtract(60,"day").format(o.DX),time_period:"60d"},period_end:{date:j,time_period:"today"},interval:"3d"});break;case"startMonth":a({period_start:{date:b,time_period:"startMonth"},period_end:{date:_,time_period:"endMonth"},interval:"1d"});break;default:console.warn("Unknown period encountered: ".concat(e))}}return(0,r.jsxs)(d.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"DateRangePicker","data-sentry-source-file":"DateRangePicker.tsx",children:[(0,r.jsx)(d.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DateRangePicker.tsx",children:(0,r.jsx)(c.$,{type:"default",iconRight:(0,r.jsx)(l.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"DateRangePicker.tsx",children:(0,r.jsx)("span",{children:y&&(null==(t=m.find(e=>e.key===y))?void 0:t.label)})})}),(0,r.jsxs)(d.SQ,{side:"bottom",align:"start",className:(0,u.cn)(!x&&"w-36",p),"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DateRangePicker.tsx",children:[(0,r.jsx)(d.Hr,{value:y,onValueChange:e=>A(e),"data-sentry-element":"DropdownMenuRadioGroup","data-sentry-source-file":"DateRangePicker.tsx",children:m.map(e=>(0,r.jsx)(d.Ht,{value:e.key,children:e.label},e.key))}),!!x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.mB,{}),x]})]})]})},p=m},12873:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/reports/database",function(){return a(31050)}])},13276:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(80263),s=a(53239),i=a(19480),l=a(29660),n=a(42889),o=a(16865),d=a(3891);let c=function(e){let{defaultValue:t,descriptionText:a,error:c,icon:u,inputRef:m,label:p,afterLabel:h,beforeLabel:g,labelOptional:f,layout:x,value:y,actions:v,size:b="medium",validation:_,id:j="",name:A="",...k}=e,w=(0,o.A)("inputNumber"),{formContextOnChange:C,values:N,errors:S,handleBlur:I,touched:E,fieldLevelValidation:P}=(0,d.x)();N&&!y&&(y=N[j||A]),c||(S&&!c&&(c=S[j||A]),c=E&&E[j||A]?c:void 0),(0,s.useEffect)(()=>{_&&P(j,_(y))},[]);let M=[w.base];return c&&M.push(w.variants.error),c||M.push(w.variants.standard),u&&M.push(w.with_icon),b&&M.push(w.size[b]),k.disabled&&M.push(w.disabled),(0,r.jsx)("div",{className:k.className,"data-sentry-component":"InputNumber","data-sentry-source-file":"InputNumber.tsx",children:(0,r.jsx)(i.H,{label:p,afterLabel:h,beforeLabel:g,labelOptional:f,layout:x,id:j,error:c,descriptionText:a,style:k.style,size:b,"data-sentry-element":"FormLayout","data-sentry-source-file":"InputNumber.tsx",children:(0,r.jsxs)("div",{className:w.container,children:[(0,r.jsx)("input",{"data-size":b,id:j,name:A,onChange:function(e){k.onChange&&k.onChange(e),C&&C(e),_&&P(j,_(e.target.value))},onBlur:function(e){I&&I(e),k.onBlur&&k.onBlur(e)},type:"number",ref:m,value:y,className:M.join(" "),...k}),u&&(0,r.jsx)(n.A,{size:b,icon:u}),c||v?(0,r.jsxs)("div",{className:w.actions_container,children:[c&&(0,r.jsx)(l.A,{size:b}),v&&v]}):null]})})})}},22186:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var r=a(80263),s=a(53434),i=a.n(s),l=a(53239),n=a(84381),o=a(52185),d=a(49911),c=a(84909),u=a(54650),m=a(73896),p=a(72883),h=a(3283);let g=e=>{var t,a;let{data:s,yAxisKey:g,xAxisKey:f,format:x,customDateFormat:y=u.C_.FULL,title:v,highlightedValue:b,highlightedLabel:_,displayDateInUtc:j,minimalHeader:A,className:k="",valuePrecision:w,size:C="normal"}=e,{Container:N}=(0,p.dQ)(C),[S,I]=(0,l.useState)(null),E=null!==S&&s&&void 0!==s[S]&&(e=>j?i()(e).utc():i()(e))(s[S][f]).format(y)||_,P=null!==S?null==(t=s[S])?void 0:t[g]:b;return 0===s.length?(0,r.jsx)(h.A,{description:"It may take up to 24 hours for data to refresh",size:C,className:k,attribute:v,format:x}):(0,r.jsxs)("div",{className:["flex flex-col gap-3",k].join(" "),"data-sentry-component":"AreaChart","data-sentry-source-file":"AreaChart.tsx",children:[(0,r.jsx)(m.A,{title:v,format:x,customDateFormat:y,highlightedValue:"number"==typeof P?(0,p.Eg)(P,w):P,highlightedLabel:E,minimalHeader:A,"data-sentry-element":"ChartHeader","data-sentry-source-file":"AreaChart.tsx"}),(0,r.jsx)(N,{"data-sentry-element":"Container","data-sentry-source-file":"AreaChart.tsx",children:(0,r.jsxs)(n.Q,{data:s,margin:{top:0,right:0,left:0,bottom:0},className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==S&&I(e.activeTooltipIndex)},onMouseLeave:()=>I(null),"data-sentry-element":"RechartAreaChart","data-sentry-source-file":"AreaChart.tsx",children:[(0,r.jsx)("defs",{"data-sentry-element":"defs","data-sentry-source-file":"AreaChart.tsx",children:(0,r.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1","data-sentry-element":"linearGradient","data-sentry-source-file":"AreaChart.tsx",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:u.OK.GREEN_1,stopOpacity:.8,"data-sentry-element":"stop","data-sentry-source-file":"AreaChart.tsx"}),(0,r.jsx)("stop",{offset:"95%",stopColor:u.OK.GREEN_1,stopOpacity:0,"data-sentry-element":"stop","data-sentry-source-file":"AreaChart.tsx"})]})}),(0,r.jsx)(o.W,{dataKey:f,interval:s.length-2,angle:0,tick:!1,axisLine:{stroke:u.OK.AXIS},tickLine:{stroke:u.OK.AXIS},"data-sentry-element":"XAxis","data-sentry-source-file":"AreaChart.tsx"}),(0,r.jsx)(d.m,{content:()=>null,"data-sentry-element":"Tooltip","data-sentry-source-file":"AreaChart.tsx"}),(0,r.jsx)(c.G,{type:"monotone",dataKey:g,stroke:u.OK.GREEN_1,fillOpacity:1,fill:"url(#colorUv)","data-sentry-element":"Area","data-sentry-source-file":"AreaChart.tsx"})]})}),s&&(0,r.jsxs)("div",{className:"text-foreground-lighter -mt-8 flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{children:i()(s[0][f]).format(y)}),(0,r.jsx)("span",{children:i()(null==(a=s[(null==s?void 0:s.length)-1])?void 0:a[f]).format(y)})]})]})}},23016:(e,t,a)=>{"use strict";a.d(t,{q:()=>d});var r=a(56947),s=a(53434),i=a.n(s),l=a(40807),n=a(61642);async function o(e,t){let{projectRef:a,attribute:r,startDate:s,endDate:i,interval:n="1h",databaseIdentifier:o}=e;if(!a)throw Error("Project ref is required");if(!r)throw Error("Attribute is required");if(!s)throw Error("Start date is required");if(!i)throw Error("End date is required");let{data:d,error:c}=await (0,l.Jt)("/platform/projects/{ref}/infra-monitoring",{params:{path:{ref:a},query:{attribute:r,startDate:s,endDate:i,interval:n,databaseIdentifier:o}},signal:t});return c&&(0,l.H4)(c),d}let d=function(e){let{projectRef:t,attribute:a,startDate:s,endDate:l,interval:d="1h",dateFormat:c="HH:mm DD MMM",databaseIdentifier:u,modifier:m}=e,{enabled:p=!0,...h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.I)(n.P.infraMonitoring(t,{attribute:a,startDate:s,endDate:l,interval:d,databaseIdentifier:u}),e=>{let{signal:r}=e;return o({projectRef:t,attribute:a,startDate:s,endDate:l,interval:d,databaseIdentifier:u},r)},{enabled:p&&void 0!==t&&void 0!==a&&void 0!==s&&void 0!==l,select:e=>({...e,data:e.data.map(e=>({...e,[a]:void 0!==m?m(Number(e[a])):Number(e[a]),periodStartFormatted:i()(e.period_start).format(c)}))}),staleTime:6e4,...h})}},27846:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(80263),s=a(47504),i=a(19898),l=a(80489);let n=e=>{let{title:t,showDatabaseSelector:a}=e,n=(0,s.useRouter)(),{ref:o}=(0,i.g)(),{db:d,chart:c,...u}=n.query;return(0,r.jsxs)("div",{className:"flex flex-row justify-between gap-4 items-center","data-sentry-component":"ReportHeader","data-sentry-source-file":"ReportHeader.tsx",children:[(0,r.jsx)("h1",{className:"text-2xl text-foreground",children:t}),a&&(0,r.jsx)(l.A,{onSelectId:e=>{n.push({pathname:n.pathname,query:e!==o?{...u,db:e}:u})}})]})}},31050:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eU});var r=a(80263),s=a(53239),i=a(60045),l=a(32144),n=a(53434),o=a.n(n),d=a(653),c=a(76733),u=a(77877),m=a(59153),p=a.n(m),h=a(73969),g=a(71126),f=a(70324),x=a(19898),y=a(27846),v=a(39532),b=a(65961),_=a(96246),j=a(1053),A=a(97872),k=a(45926),w=a(80125),C=a(41370),N=a(47504),S=a(16632),I=a(22186),E=a(61068),P=a(23016),M=a(89452),D=a(8945),T=a(64452),R=a(33446),L=a(51626),z=a(83086);let O=e=>{var t,a,i,l;let{label:n,attribute:o,provider:d,startDate:c,endDate:u,interval:m,customDateFormat:p,children:h=null,defaultChartStyle:f="bar",hideChartType:x=!1,data:y,isLoading:v,format:b,highlightedValue:_,...j}=e,{ref:A}=(0,N.useRouter)().query,k=(0,L.RE)(),[w,C]=(0,s.useState)(f),O=k.selectedDatabaseId,{data:q,isLoading:G}=(0,M.J)({projectRef:A,attribute:o,startDate:c,endDate:u,interval:m,databaseIdentifier:O},{enabled:"daily-stats"===d&&void 0===y}),{data:H,isLoading:B}=(0,P.q)({projectRef:A,attribute:o,startDate:c,endDate:u,interval:m,databaseIdentifier:O},{enabled:"infra-monitoring"===d&&void 0===y}),U=y||("infra-monitoring"===d?H:"daily-stats"===d?q:void 0),F="daily-stats"===d&&!o.includes("ingress")&&!o.includes("egress")&&void 0!==U&&"maximum"in U,V=void 0!==U&&"totalGrouped"in U,K=void 0!==_?_:F?null==U?void 0:U.maximum:"daily-stats"===d?null==U?void 0:U.total:V?null==U||null==(t=U.totalGrouped)?void 0:t[o]:null==U||null==(a=U.data[(null==U?void 0:U.data.length)-1])?void 0:a[o];return v||("infra-monitoring"===d?B:"daily-stats"===d?G:v)?(0,r.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,r.jsx)(D.A,{size:18,className:"animate-spin text-border-strong"}),(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Loading data for ",n]})]}):void 0===U?(0,r.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,r.jsx)(z.id,{}),(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Unable to load data for ",n]})]}):(0,r.jsxs)("div",{className:"h-full w-full","data-sentry-component":"ChartHandler","data-sentry-source-file":"ChartHandler.tsx",children:[(0,r.jsxs)("div",{className:"absolute right-6 z-10 flex justify-between",children:[!x&&(0,r.jsxs)(S.m_,{children:[(0,r.jsx)(S.k$,{asChild:!0,children:(0,r.jsx)(g.$,{type:"default",className:"px-1.5",icon:"bar"===w?(0,r.jsx)(T.A,{}):(0,r.jsx)(R.A,{}),onClick:()=>C("bar"===w?"line":"bar")})}),(0,r.jsxs)(S.ZI,{side:"left",align:"center",children:["View as ","bar"===w?"line chart":"bar chart"]})]}),h]}),"bar"===w?(0,r.jsx)(E.A,{data:null!=(i=null==U?void 0:U.data)?i:[],format:b||(null==U?void 0:U.format),xAxisKey:"period_start",yAxisKey:o,highlightedValue:K,title:n,customDateFormat:p,...j}):(0,r.jsx)(I.A,{data:null!=(l=null==U?void 0:U.data)?l:[],format:b||(null==U?void 0:U.format),xAxisKey:"period_start",yAxisKey:o,highlightedValue:K,title:n,customDateFormat:p,...j})]})};var q=a(21889),G=a(46036),H=a(51859),B=a(796),U=a(72055),F=a(11722),V=a(69838),K=a(52185),X=a(49911),Y=a(30381),W=a(84909),Q=a(15614),$=a(6235),Z=a(62247),J=a(83792),ee=a(73896),et=a(95285);let ea=(0,a(23983).A)("Logs",[["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 18h1",key:"1eiwyy"}],["path",{d:"M3 6h1",key:"rgxa97"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M8 6h1",key:"tn6mkg"}]]);var er=a(74115);let es=e=>{var t,a;let{chartHighlight:i,updateDateRange:l}=e,n=(0,N.useRouter)(),{ref:d}=n.query,{left:u,right:m,clearHighlight:p}=null!=i?i:{},[h,g]=(0,s.useState)(!!(null==i?void 0:i.popoverPosition));(0,s.useEffect)(()=>{g(!!(null==i?void 0:i.popoverPosition)&&u!==m)},[null==i?void 0:i.popoverPosition]);let f=10>o()(m).diff(o()(u),"minutes");return(0,r.jsxs)(er.rI,{open:h,onOpenChange:g,"data-sentry-element":"DropdownMenu","data-sentry-component":"ChartHighlightActions","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,r.jsx)(er.ty,{className:"w-auto p-0",style:{position:"absolute",left:(null==i||null==(t=i.popoverPosition)?void 0:t.x)+"px",top:(null==i||null==(a=i.popoverPosition)?void 0:a.y)+"px"},"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,r.jsxs)(er.SQ,{className:"flex flex-col gap-1 p-1 w-fit text-left","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,r.jsxs)(er.lp,{className:"flex items-center justify-center text-foreground-lighter font-mono gap-1 text-xs","data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,r.jsx)("span",{children:o()(u).format("MMM D, H:mm")}),(0,r.jsx)(c.A,{size:10,"data-sentry-element":"ArrowRight","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,r.jsx)("span",{children:o()(m).format("MMM D, H:mm")})]}),(0,r.jsx)(er.mB,{className:"my-0","data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,r.jsx)(er._2,{disabled:f,className:(0,H.cn)("group",f&&"!bg-transparent"),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"ChartHighlightActions.tsx",children:(0,r.jsxs)("button",{disabled:f,onClick:()=>{!f&&(l(u,m),p&&p())},className:"w-full flex items-center gap-1.5",children:[(0,r.jsx)(et.A,{className:"text-foreground-lighter",size:12,"data-sentry-element":"SearchIcon","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,r.jsx)("span",{className:"flex-grow text-left text-foreground-light",children:"Zoom in"}),f&&(0,r.jsx)("span",{className:"text-xs",children:"Min. 10 minutes"})]})}),(0,r.jsx)(er._2,{className:(0,H.cn)("group",f&&"!bg-transparent"),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"ChartHighlightActions.tsx",children:(0,r.jsxs)("button",{onClick:()=>{let e="?its=".concat(u,"&ite=").concat(m);n.push("/project/".concat(d,"/logs/postgres-logs").concat(e)),p&&p()},className:"w-full flex items-center gap-1.5",children:[(0,r.jsx)(ea,{className:"text-foreground-lighter",size:12,"data-sentry-element":"LogsIcon","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,r.jsx)("span",{className:"flex-grow text-left text-foreground-light",children:"Open range in Logs Explorer"})]})})]})]})};var ei=a(54650),el=a(72883),en=a(49443);let eo=e=>{let{color:t}=e;return(0,r.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-component":"CustomIcon","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,r.jsx)("circle",{cx:"5",cy:"5",r:"3",fill:t,"data-sentry-element":"circle","data-sentry-source-file":"ComposedChart.utils.tsx"})})},ed=e=>{let{color:t}=e;return(0,r.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-component":"MaxConnectionsIcon","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,r.jsx)("line",{x1:"2",y1:"6",x2:"12",y2:"6",stroke:null!=t?t:ei.OK.REFERENCE_LINE,strokeWidth:"2",strokeDasharray:"2 2","data-sentry-element":"line","data-sentry-source-file":"ComposedChart.utils.tsx"})})},ec=e=>null==e?void 0:e.find(e=>e.isMaxValue),eu=(e,t)=>null==e?void 0:e.filter(e=>!(null==t?void 0:t.includes(e.dataKey))).reduce((e,t)=>e+t.value,0),em=e=>{let{active:t,payload:a,attributes:s,isPercentage:i,valuePrecision:l,showTotal:n,isActiveHoveredChart:d}=e;if(t&&a&&a.length){var c,u,m,p;let e=a[0].payload.timestamp,h=ec(s),g=h&&(null==a?void 0:a.find(e=>e.dataKey===h.attribute)),f=null==g?void 0:g.value,x=null==a?void 0:a.some(e=>e.dataKey.toLowerCase().includes("ram_")),y=null==a?void 0:a.some(e=>e.dataKey.toLowerCase().includes("disk_space_")),v=null==a?void 0:a.some(e=>e.dataKey.toLowerCase().includes("pg_database_size")),b=null==a?void 0:a.some(e=>e.dataKey.toLowerCase().includes("network_")),_=x||y||v||b,j=[...null!=(m=null==s||null==(c=s.filter(e=>e.omitFromTotal))?void 0:c.map(e=>e.attribute))?m:[],...null!=(p=null==s||null==(u=s.filter(e=>(null==e?void 0:e.provider)==="reference-line"))?void 0:u.map(e=>e.attribute))?p:[],...(null==h?void 0:h.attribute)?[h.attribute]:[]],A=n&&eu(a,j),k=(e,t)=>t?(0,r.jsx)(ed,{}):(0,r.jsx)(eo,{color:e}),w=e=>{let{entry:t}=e,a=null==s?void 0:s.find(e=>(null==e?void 0:e.attribute)===t.name),n=(t.value/f*100).toFixed(1),o=t.dataKey===(null==h?void 0:h.attribute);return(0,r.jsxs)("div",{className:"flex items-center w-full","data-sentry-component":"LabelItem","data-sentry-source-file":"ComposedChart.utils.tsx",children:[k(t.color,o),(0,r.jsx)("span",{className:"text-foreground-lighter ml-1 flex-grow",children:(null==a?void 0:a.label)||t.name}),(0,r.jsxs)("span",{className:"ml-3.5 flex items-end gap-1",children:[_?(0,en.z3)(b?Math.abs(t.value):t.value,l):(0,el.Eg)(t.value,l),i?"%":"",!!g&&!o&&(0,r.jsxs)("span",{className:"text-[11px] text-foreground-light mb-0.5",children:["(",n,"%)"]})]})]},t.name)};return(0,r.jsxs)("div",{className:(0,H.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg px-2.5 py-1.5 text-xs shadow-xl transition-opacity opacity-100",!d&&"opacity-0"),children:[(0,r.jsx)("p",{className:"font-medium",children:o()(e).format(ei.C_.FULL_SECONDS)}),(0,r.jsxs)("div",{className:"grid gap-0",children:[a.reverse().map((e,t)=>(0,r.jsx)(w,{entry:e},"".concat(e.name,"-").concat(t))),t&&n&&(0,r.jsxs)("div",{className:"flex md:flex-col gap-1 md:gap-0 text-foreground mt-1",children:[(0,r.jsx)("span",{className:"flex-grow text-foreground-lighter",children:"Total"}),(0,r.jsxs)("div",{className:"flex items-end gap-1",children:[(0,r.jsxs)("span",{className:"text-base",children:[_?(0,en.z3)(v?1024*A*1024:A,l):(0,el.Eg)(A,l),i?"%":""]}),h&&!isNaN(A/(null==g?void 0:g.value))&&isFinite(A/(null==g?void 0:g.value))&&(0,r.jsxs)("span",{className:"text-[11px] text-foreground-light mb-0.5",children:["(",(A/(null==g?void 0:g.value)*100).toFixed(1),"%)"]})]})]})]})]})}return null},ep=e=>{let{payload:t,attributes:a,showMaxValue:i,onLabelHover:l}=e,n=null!=t?t:[],o=ec(a),[d,c]=(0,s.useState)(null),u=e=>{c(e),null==l||l(e)},m=()=>{c(null),null==l||l(null)},p=(e,t)=>e===(null==o?void 0:o.attribute)==!0?(0,r.jsx)(ed,{}):(0,r.jsx)(eo,{color:t}),h=e=>{let{entry:t}=e,s=null==a?void 0:a.find(e=>e.attribute===t.name),l=t.name===(null==o?void 0:o.attribute),n=d===t.name,c=()=>(0,r.jsxs)("div",{className:"flex items-center gap-1 p-1","data-sentry-component":"Label","data-sentry-source-file":"ComposedChart.utils.tsx",children:[p(t.name,t.color),(0,r.jsx)("span",{className:(0,H.cn)("text-nowrap text-foreground-lighter",d&&!n&&"opacity-50"),children:(null==s?void 0:s.label)||t.name})]});return!i&&l?null:(0,r.jsx)("div",{className:"inline-flex md:flex-col gap-1 md:gap-0 w-fit text-foreground",onMouseOver:()=>u(t.name),onMouseOutCapture:m,"data-sentry-component":"LabelItem","data-sentry-source-file":"ComposedChart.utils.tsx",children:(null==s?void 0:s.tooltip)?(0,r.jsxs)(S.m_,{children:[(0,r.jsx)(S.k$,{children:(0,r.jsx)(c,{})}),(0,r.jsx)(S.ZI,{side:"bottom",align:"center",className:"max-w-[250px]",children:s.tooltip})]}):(0,r.jsx)(c,{})},t.name)};return(0,r.jsx)("div",{className:"relative z-0 mx-auto flex flex-col items-center gap-1 text-xs w-full","data-sentry-component":"CustomLabel","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,r.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:null==n?void 0:n.map((e,t)=>(0,r.jsx)(h,{entry:e},"".concat(e.name,"-").concat(t)))})})};var eh=a(3283);function eg(e){var t,a,i,l,n,d,c,u,m,p;let{data:h,attributes:g,yAxisKey:f,xAxisKey:x,format:y,customDateFormat:v=ei.C_.FULL,title:b,highlightedValue:_,highlightedLabel:j,displayDateInUtc:A,minimalHeader:k,valuePrecision:w,className:C="",size:N="normal",emptyStateMessage:S,onBarClick:I,showLegend:E=!1,xAxisIsDate:P=!0,XAxisProps:M,YAxisProps:D,showGrid:T=!1,showTooltip:R=!1,showTotal:L=!0,showMaxValue:z=!1,chartHighlight:O,hideChartType:q,chartStyle:G,onChartStyleChange:et,updateDateRange:ea,hideYAxis:er,hideHighlightedValue:eo,syncId:ed,docsUrl:ec}=e,{resolvedTheme:eg}=(0,B.D)(),[ef,ex]=(0,s.useState)(null),[ey,ev]=(0,s.useState)(z),[eb,e_]=(0,s.useState)(null),[ej,eA]=(0,s.useState)(null),[ek,ew]=(0,s.useState)(!1),eC=null==eg?void 0:eg.includes("dark");(0,s.useEffect)(()=>{(0,ei.fE)(null!=eC&&eC)},[eg]);let{Container:eN}=(0,el.dQ)(N),eS=M||{interval:h.length-2,angle:0,tick:!1},eI=D||{tickFormatter:e=>(0,el.Eg)(e,w),tick:!1,width:0},eE=e=>A?o()(e).utc():o()(e),eP=g.find(e=>e.isMaxValue),eM={name:null==eP?void 0:eP.attribute,color:ei.OK.REFERENCE_LINE},eD=h[h.length-1]?Object.entries(h[h.length-1]).map(e=>{let[t,a]=e;return{dataKey:t,value:a}}).filter(e=>"timestamp"!==e.dataKey):void 0,eT=g.filter(e=>(null==e?void 0:e.provider)==="reference-line"),eR=function(){if(!P){var e;return eb?null==(e=h[eb])?void 0:e.timestamp:j}return null!==eb&&h&&void 0!==h[eb]&&eE(h[eb].timestamp).format(v)||j}(),eL=[...null!=(u=null==g||null==(t=g.filter(e=>e.omitFromTotal))?void 0:t.map(e=>e.attribute))?u:[],...null!=(m=null==eT?void 0:eT.map(e=>e.attribute))?m:[],...(null==eP?void 0:eP.attribute)?[null==eP?void 0:eP.attribute]:[]],ez=null!==eb?L?eu(ef,eL):null==(a=h[eb])?void 0:a[f]:L&&eD?eu(eD,eL):_,eO=(null==O?void 0:O.coordinates.left)&&(null==O?void 0:O.coordinates.right)&&(null==O?void 0:O.coordinates.left)!==(null==O?void 0:O.coordinates.right),eq=h&&h[0]?null==(i=Object.entries(h[0]))?void 0:i.map((e,t)=>{let[a,r]=e;return{name:a,value:r,color:ei.E6[t-1%ei.E6.length]}}).filter(e=>"timestamp"!==e.name&&e.name!==(null==eP?void 0:eP.attribute)&&!eT.map(e=>e.attribute).includes(e.name)):[],eG=eq.filter(e=>!e.name.includes("max")),eH="%"===y,eB=null==eq?void 0:eq.some(e=>e.name.toLowerCase().includes("ram_")),eU=null==eq?void 0:eq.some(e=>e.name.toLowerCase().includes("disk_space_")),eF=null==eq?void 0:eq.some(e=>e.name.toLowerCase().includes("pg_database_size")),eV=null==eq?void 0:eq.some(e=>e.name.toLowerCase().includes("network_")),eK=[0,Math.max(...eq.map(e=>"number"==typeof e.value?e.value:0))];return 0===h.length?(0,r.jsx)(eh.A,{message:S,description:"It may take up to 24 hours for data to refresh",size:N,className:C,attribute:b,format:y}):(0,r.jsxs)("div",{className:(0,H.cn)("flex flex-col gap-y-3",C),"data-sentry-component":"ComposedChart","data-sentry-source-file":"ComposedChart.tsx",children:[(0,r.jsx)(ee.A,{title:b,format:y,customDateFormat:v,highlightedValue:"number"==typeof ez?eB||eU||eF||eV?(0,en.z3)(eV?Math.abs(ez):ez,w):(0,el.Eg)(ez,w):ez,highlightedLabel:eR,minimalHeader:k,hideChartType:q,chartStyle:G,onChartStyleChange:et,showMaxValue:ey,setShowMaxValue:eP?ev:void 0,hideHighlightedValue:eo,docsUrl:ec,"data-sentry-element":"ChartHeader","data-sentry-source-file":"ComposedChart.tsx"}),(0,r.jsxs)(eN,{className:"relative z-10","data-sentry-element":"Container","data-sentry-source-file":"ComposedChart.tsx",children:[(0,r.jsxs)(U.X,{data:h,syncId:ed,onMouseMove:e=>{var t;ew(!0),e.activeTooltipIndex!==eb&&(e_(e.activeTooltipIndex),ex(e.activePayload));let a=null==(t=h[e.activeTooltipIndex])?void 0:t.timestamp;null==O||O.handleMouseMove({activeLabel:null==a?void 0:a.toString(),coordinates:e.activeLabel})},onMouseDown:e=>{var t;let a=null==(t=h[e.activeTooltipIndex])?void 0:t.timestamp;null==O||O.handleMouseDown({activeLabel:null==a?void 0:a.toString(),coordinates:e.activeLabel})},onMouseUp:null==O?void 0:O.handleMouseUp,onMouseLeave:e=>{ew(!1),e_(null),ex(null)},onClick:e=>{var t,a;let r=null==e||null==(a=e.activePayload)||null==(t=a[0])?void 0:t.payload;I&&I(r,e)},"data-sentry-element":"RechartComposedChart","data-sentry-source-file":"ComposedChart.tsx",children:[T&&(0,r.jsx)(F.d,{stroke:ei.OK.AXIS}),(0,s.createElement)(V.h,{...eI,hide:er,axisLine:{stroke:ei.OK.AXIS},tickLine:{stroke:ei.OK.AXIS},domain:eH&&!z?eK:["auto","auto"],key:f,"data-sentry-element":"YAxis","data-sentry-source-file":"ComposedChart.tsx"}),(0,s.createElement)(K.W,{...eS,axisLine:{stroke:ei.OK.AXIS},tickLine:{stroke:ei.OK.AXIS},tickMargin:8,minTickGap:3,key:x,"data-sentry-element":"XAxis","data-sentry-source-file":"ComposedChart.tsx"}),(0,r.jsx)(X.m,{content:e=>R?(0,r.jsx)(em,{...e,isPercentage:eH,label:eR,attributes:g,valuePrecision:w,showTotal:L,isActiveHoveredChart:ek}):null,"data-sentry-element":"Tooltip","data-sentry-source-file":"ComposedChart.tsx"}),"bar"===G?eG.map(e=>{var t,a,s;return(0,r.jsx)(Y.y,{dataKey:e.name,stackId:null!=(s=null==g||null==(t=g.find(t=>t.attribute===(null==e?void 0:e.name)))?void 0:t.stackId)?s:"1",fill:e.color,fillOpacity:ej&&ej!==(null==e?void 0:e.name)?.25:1,radius:.75,opacity:ej&&ej!==(null==e?void 0:e.name)?.5:1,name:(null==g||null==(a=g.find(t=>t.attribute===(null==e?void 0:e.name)))?void 0:a.label)||(null==e?void 0:e.name)},e.name)}):eG.map((e,t)=>{var a,s,i;return(0,r.jsx)(W.G,{type:"step",dataKey:e.name,stackId:null!=(i=null==g||null==(a=g.find(t=>t.attribute===e.name))?void 0:a.stackId)?i:"1",fill:e.color,strokeOpacity:ej&&ej!==e.name?.4:1,stroke:e.color,radius:20,animationDuration:375,fillOpacity:ej&&ej!==e.name?.075:ej===e.name?.3:.25,name:(null==g||null==(s=g.find(t=>t.attribute===e.name))?void 0:s.label)||e.name,dot:!1},e.name)}),eP&&ey&&(0,r.jsx)(Q.N,{type:"stepAfter",dataKey:eP.attribute,stroke:ei.OK.REFERENCE_LINE,strokeWidth:2,strokeDasharray:null!=(p=eP.strokeDasharray)?p:"3 3",dot:!1,name:eP.label},eP.attribute),eT.filter(e=>e.isReferenceLine).map(e=>{var t;return(0,r.jsx)($.e,{y:e.value,strokeWidth:1,...e,strokeDasharray:null!=(t=e.strokeDasharray)?t:"3 3",label:void 0,children:(0,r.jsx)(Z.J,{value:e.label,position:"insideTopRight",fill:ei.OK.REFERENCE_LINE_TEXT,className:"text-xs",style:{fill:ei.OK.REFERENCE_LINE_TEXT}})},e.attribute)}),eO&&(0,r.jsx)(J.T,{x1:null==O?void 0:O.coordinates.left,x2:null==O?void 0:O.coordinates.right,strokeOpacity:.5,stroke:"#3ECF8E",fill:"#3ECF8E",fillOpacity:.3})]}),(0,r.jsx)(es,{chartHighlight:O,updateDateRange:ea,"data-sentry-element":"ChartHighlightActions","data-sentry-source-file":"ComposedChart.tsx"})]}),h&&(0,r.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",style:{marginLeft:null==D?void 0:D.width},children:[(0,r.jsx)("span",{children:P?eE(null==(l=h[0])?void 0:l.timestamp).format(v):null==(n=h[0])?void 0:n.timestamp}),(0,r.jsx)("span",{children:P?eE(null==(d=h[(null==h?void 0:h.length)-1])?void 0:d.timestamp).format(v):null==(c=h[(null==h?void 0:h.length)-1])?void 0:c.timestamp})]}),E&&(0,r.jsx)(ep,{payload:[eM,...eq],attributes:g,showMaxValue:ey,onLabelHover:eA})]})}let ef=e=>{let{children:t}=e,[a,i]=(0,s.useState)(!1),l=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=new IntersectionObserver(t=>{let[a]=t;a.isIntersecting&&(i(!0),e.disconnect())},{rootMargin:"150px 0px",threshold:0}),t=l.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[]),(0,r.jsx)("div",{ref:l,"data-sentry-component":"LazyChartWrapper","data-sentry-source-file":"ComposedChartHandler.tsx",children:s.cloneElement(t,{isVisible:a})})},ex=e=>{let{label:t,attributes:a,startDate:i,endDate:l,interval:n,customDateFormat:d,children:c=null,defaultChartStyle:u="bar",hideChartType:m=!1,data:p,isLoading:h,format:g,highlightedValue:f,className:x,showTooltip:y,showLegend:v,showMaxValue:b,showTotal:_,updateDateRange:j,valuePrecision:A,isVisible:k=!0,id:w,...C}=e,{ref:S}=(0,N.useRouter)().query,I=(0,L.RE)(),[E,P]=(0,s.useState)(u),M=function(){let[e,t]=(0,s.useState)(void 0),[a,r]=(0,s.useState)(void 0),[i,l]=(0,s.useState)({left:void 0,right:void 0}),[n,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(null),[m,p]=(0,s.useState)(void 0),h=()=>{t(void 0),r(void 0),l({left:void 0,right:void 0}),u(null),p(void 0)};return{left:e,right:a,coordinates:i,isSelecting:n,popoverPosition:c,handleMouseDown:e=>{h(),e&&e.activeLabel&&(d(!0),t(e.activeLabel),r(e.activeLabel),p(e.activeLabel),l({left:e.coordinates,right:e.coordinates}))},handleMouseMove:e=>{if(!n||!e||!e.activeLabel)return;let a=o()(e.activeLabel),s=o()(m);a.isBefore(s)?(t(e.activeLabel),r(m),l({left:e.coordinates,right:i.right})):(r(e.activeLabel),t(m),l({left:i.left,right:e.coordinates}))},handleMouseUp:e=>{n&&(d(!1),u({x:e.chartX,y:e.chartY}),p(void 0))},clearHighlight:h}}(),T=ey(a,S,i,l,n,I.selectedDatabaseId,p,k),R=(0,s.useMemo)(()=>{if(p)return p;if(T.some(e=>e.isLoading)||T.some(e=>!e.data))return;let e=new Set;T.forEach(t=>{var a,r;null==(r=t.data)||null==(a=r.data)||a.forEach(t=>{(null==t?void 0:t.period_start)&&e.add(t.period_start)})});let t=T.filter((e,t)=>"reference-line"===a[t].provider);return Array.from(e).sort().map(e=>{let r={timestamp:e};return a.forEach((t,a)=>{var s,i,l;if(!t)return;if(void 0!==t.customValue){r[t.attribute]=t.customValue;return}if("reference-line"===t.provider)return;let n=null==(i=T[a])||null==(s=i.data)?void 0:s.data,o=null==n?void 0:n.find(t=>t.period_start===e);r[t.attribute]=null!=(l=null==o?void 0:o[t.attribute])?l:0}),t.forEach(e=>{let t=e.data.attribute,a=e.data.total;r[t]=a}),r})},[p,T,a]),O=h||T.some(e=>e.isLoading),G=(0,s.useMemo)(()=>{var e,t;if(void 0!==f)return f;let r=a[0],s=T[0],i=null==s?void 0:s.data;if(!i)return;let l="daily-stats"===r.provider&&!r.attribute.includes("ingress")&&!r.attribute.includes("egress")&&"maximum"in i,n="totalGrouped"in i;return l?i.maximum:"daily-stats"===r.provider?i.total:n?null==(e=i.totalGrouped)?void 0:e[r.attribute]:null==(t=i.data[i.data.length-1])?void 0:t[r.attribute]},[f,a,T]);return O?(0,r.jsxs)(q.A,{className:(0,H.cn)("flex min-h-[320px] w-full flex-col items-center justify-center gap-y-2",x),wrapWithLoading:!1,noMargin:!0,noHideOverflow:!0,children:[(0,r.jsx)(D.A,{size:18,className:"animate-spin text-border-strong"}),(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Loading data for ",t]})]}):R?(0,r.jsx)(q.A,{noMargin:!0,noHideOverflow:!0,className:(0,H.cn)("relative py-2 w-full scroll-mt-16",x),wrapWithLoading:!1,id:null!=w?w:t.toLowerCase().replaceAll(" ","-"),"data-sentry-element":"Panel","data-sentry-component":"ComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx",children:(0,r.jsxs)(q.A.Content,{className:"flex flex-col gap-4","data-sentry-element":"unknown","data-sentry-source-file":"ComposedChartHandler.tsx",children:[(0,r.jsx)("div",{className:"absolute right-6 z-50 flex justify-between scroll-mt-16",children:c}),(0,r.jsx)(eg,{attributes:a,data:R,format:g,xAxisKey:"period_start",yAxisKey:a[0].attribute,highlightedValue:G,title:t,customDateFormat:d,chartHighlight:M,chartStyle:E,showTooltip:y,showLegend:v,showTotal:_,showMaxValue:b,onChartStyleChange:P,updateDateRange:j,valuePrecision:A,hideChartType:m,...C,"data-sentry-element":"ComposedChart","data-sentry-source-file":"ComposedChartHandler.tsx"})]})}):(0,r.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,r.jsx)(z.id,{}),(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Unable to load data for ",t]})]})},ey=(e,t,a,r,s,i,l,n)=>{let o=e.filter(e=>(null==e?void 0:e.provider)==="infra-monitoring").map(e=>e.attribute),d=e.filter(e=>(null==e?void 0:e.provider)==="daily-stats").map(e=>e.attribute),c=e.filter(e=>(null==e?void 0:e.provider)==="reference-line"),u=o.map(e=>(0,P.q)({projectRef:t,attribute:e,startDate:a,endDate:r,interval:s,databaseIdentifier:i},{enabled:void 0===l&&n}));return[...u,...d.map(e=>(0,M.J)({projectRef:t,attribute:e,startDate:a,endDate:r,interval:s,databaseIdentifier:i},{enabled:void 0===l&&n})),...c.map(e=>{let t=e.value||0;return{data:{data:[],attribute:e.attribute,total:t,maximum:t,totalGrouped:{[e.attribute]:t}},isLoading:!1,isError:!1}})]};function ev(e){return(0,r.jsx)(ef,{"data-sentry-element":"LazyChartWrapper","data-sentry-component":"LazyComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx",children:(0,r.jsx)(ex,{...e,"data-sentry-element":"ComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx"})})}var eb=a(10906),e_=a(8479),ej=a(64652),eA=a(34969),ek=a(64036);let ew=e=>{let{className:t}=e,{ref:a}=(0,x.g)(),s=(0,eA.a)(),{mutate:i}=(0,ej.h)();return(0,r.jsxs)("div",{className:(0,H.cn)("flex gap-2",t),"data-sentry-component":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,r.jsx)(g.$,{type:"outline",className:"bg-alternative",size:"tiny",icon:(0,r.jsx)(e_.A,{}),asChild:!0,"data-sentry-element":"Button","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,r.jsx)(p(),{href:"https://supabase.com/docs/guides/telemetry/metrics",target:"_blank",onClick:()=>{var e;return i({action:"reports_database_grafana_banner_clicked",groups:{project:null!=a?a:"Unknown",organization:null!=(e=null==s?void 0:s.slug)?e:"Unknown"}})},"data-sentry-element":"Link","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Docs"})}),(0,r.jsx)(g.$,{type:"default",size:"tiny",asChild:!0,"data-sentry-element":"Button","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,r.jsx)(p(),{href:"https://github.com/supabase/supabase-grafana",target:"_blank",onClick:()=>{var e;return i({action:"reports_database_grafana_banner_clicked",groups:{project:null!=a?a:"Unknown",organization:null!=(e=null==s?void 0:s.slug)?e:"Unknown"}})},"data-sentry-element":"Link","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Configure Grafana"})})]})},eC=()=>(0,r.jsxs)(f.Fc,{className:"relative overflow-hidden","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"GrafanaPromoBanner","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,r.jsxs)("div",{className:"absolute inset-0 z-0",children:[(0,r.jsx)("img",{src:"".concat(ek.o2,"/img/reports/bg-grafana-dark.svg"),alt:"Supabase Grafana",className:"w-full h-full object-cover object-right hidden dark:block"}),(0,r.jsx)("img",{src:"".concat(ek.o2,"/img/reports/bg-grafana-light.svg"),alt:"Supabase Grafana",className:"w-full h-full object-cover object-right dark:hidden"}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-background-alternative to-transparent"})]}),(0,r.jsx)("svg",{width:"78",height:"86",viewBox:"0 0 78 86",className:"w-4 h-4",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,r.jsx)("path",{d:"M77.777 38.148c-.15-1.344-.299-2.987-.896-4.778-.448-1.792-1.194-3.733-2.24-5.823-1.045-2.09-2.388-4.18-4.03-6.27-.598-.747-1.344-1.643-2.24-2.39 1.194-4.777-1.493-8.808-1.493-8.808-4.48-.299-7.465 1.343-8.51 2.24-.15 0-.3-.15-.598-.3a41.262 41.262 0 0 0-2.388-.895c-.896-.299-1.643-.448-2.538-.747-.896-.15-1.792-.298-2.539-.448h-.448C47.917 3.66 42.243.971 42.243.971c-6.27 4.031-7.465 9.556-7.465 9.556v.298c-.299.15-.747.15-1.045.299-.448.15-.896.298-1.493.448-.448.149-.896.298-1.493.597-.896.448-1.941.896-2.837 1.344-.896.447-1.792 1.045-2.688 1.642-.149 0-.149-.15-.149-.15-8.809-3.284-16.572.747-16.572.747-.747 9.257 3.434 15.229 4.33 16.274-.15.597-.448 1.194-.598 1.792-.597 2.09-1.194 4.33-1.493 6.57 0 .298-.15.596-.15.895C2.529 45.314.14 53.526.14 53.526c6.718 7.763 14.631 8.211 14.631 8.211 1.045 1.792 2.09 3.434 3.434 5.077.597.597 1.195 1.343 1.643 1.94-2.39 7.018.298 12.84.298 12.84 7.465.3 12.392-3.284 13.437-4.18.747.299 1.493.448 2.24.747 2.24.597 4.628.895 7.017 1.045h2.837c3.583 5.076 9.705 5.822 9.705 5.822 4.479-4.628 4.628-9.256 4.628-10.302v-.299c.896-.596 1.791-1.343 2.688-2.09 1.791-1.642 3.284-3.433 4.628-5.374.15-.15.298-.299.298-.597 5.077.298 8.51-3.136 8.51-3.136-.895-5.225-3.882-7.763-4.479-8.211h-.149V48.748c-.15-.597-.15-1.194-.298-1.642-.597-2.24-1.344-4.33-2.538-6.271-1.195-1.941-2.539-3.583-4.181-5.076-1.642-1.493-3.434-2.538-5.375-3.434-1.94-.896-3.882-1.344-5.972-1.643-1.045-.149-1.94-.149-2.986-.149H48.663c-.448 0-1.045.15-1.493.15a14.617 14.617 0 0 0-5.524 2.09c-1.643 1.045-3.136 2.24-4.33 3.583-1.195 1.344-2.09 2.986-2.688 4.628-.597 1.643-.895 3.285-1.045 4.927V48.3c.15.746.299 1.643.448 2.389.448 1.493 1.195 2.837 1.941 4.03.896 1.196 1.941 2.091 2.986 2.838 1.045.746 2.24 1.343 3.434 1.642 1.195.299 2.24.448 3.434.448H47.767c.15 0 .299 0 .448-.15.298 0 .448-.148.747-.148.448-.15.895-.3 1.343-.598.448-.15.747-.448 1.195-.746.149 0 .15-.15.298-.299.448-.299.448-.896.15-1.194-.299-.299-.747-.448-1.045-.15-.15 0-.15.15-.299.15-.299.149-.597.298-1.045.447-.299.15-.747.15-1.045.299h-2.389c-.896-.15-1.643-.299-2.538-.746-.896-.299-1.643-.896-2.39-1.493-.746-.598-1.343-1.493-1.79-2.24-.448-.746-.897-1.792-1.046-2.836-.15-.448-.15-1.046-.15-1.494v-.746c0-.299 0-.598.15-.896a11.78 11.78 0 0 1 3.285-6.121c.448-.448.895-.747 1.343-1.195.448-.298 1.046-.597 1.493-.896.598-.298 1.195-.447 1.643-.597.597-.15 1.194-.298 1.791-.298h1.792c.597 0 1.344.149 1.94.298 1.345.299 2.539.747 3.734 1.493 2.388 1.344 4.33 3.434 5.673 5.823.597 1.194 1.045 2.538 1.344 3.882 0 .299.149.747.149 1.045V52.63c0 .448 0 .746-.15 1.194 0 .299-.149.747-.149 1.045 0 .299-.149.747-.298 1.046-.15.746-.448 1.492-.747 2.09a27.148 27.148 0 0 1-2.24 4.03c-1.79 2.39-4.18 4.48-7.016 5.674-1.344.598-2.837 1.045-4.33 1.344-.747.15-1.493.15-2.24.299H43.14c-1.642-.15-3.285-.448-4.778-.896-1.493-.448-3.135-1.045-4.479-1.792-2.837-1.493-5.375-3.583-7.465-6.121-1.045-1.194-1.941-2.538-2.538-4.031a28.024 28.024 0 0 1-1.792-4.48c-.448-1.492-.746-3.135-.746-4.628V44.567c0-.746.149-1.642.149-2.388.15-.747.299-1.643.448-2.389.15-.747.298-1.642.597-2.389.448-1.493 1.045-2.986 1.642-4.48 1.344-2.836 2.986-5.374 5.077-7.315.447-.448 1.045-1.045 1.642-1.493.597-.448 1.194-.896 1.792-1.194.597-.448 1.194-.747 1.791-1.046l.896-.447c.15 0 .299-.15.448-.15.15 0 .298-.149.448-.149.597-.299 1.344-.448 1.94-.746.15 0 .3-.15.449-.15.149 0 .299-.15.448-.15.298-.148.746-.148 1.045-.298.149 0 .298-.149.597-.149.15 0 .298 0 .597-.15.15 0 .299 0 .597-.149h.597c.15 0 .299 0 .598-.149.15 0 .448 0 .597-.15h5.225c1.344 0 2.688.15 4.032.449 2.538.448 4.927 1.343 7.166 2.389a23.309 23.309 0 0 1 5.823 3.881l.299.299.298.299c.15.149.448.298.597.597.15.298.448.298.598.597.149.299.448.448.597.597a15.109 15.109 0 0 1 1.94 2.39c1.195 1.492 2.24 3.134 2.987 4.627 0 .15.15.15.15.3 0 .148.148.148.148.298.15.149.15.298.299.597.15.15.15.298.299.597.149.15.149.299.298.597.3.747.598 1.344.747 1.941.298 1.045.597 1.941.746 2.688.15.298.448.597.747.448.298 0 .597-.299.597-.598.597-1.791.597-2.837.448-3.882Z",fill:"currentColor","data-sentry-element":"path","data-sentry-source-file":"GrafanaPromoBanner.tsx"})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 mt-1",children:[(0,r.jsx)(f.XL,{className:"flex-grow","data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Advanced observability"}),(0,r.jsx)(ew,{className:"hidden xl:flex","data-sentry-element":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx"})]}),(0,r.jsxs)(f.TN,{className:"relative flex flex-col xl:flex-row gap-2 md:max-w-lg","data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,r.jsx)("p",{className:"flex-grow",children:"Set up the Supabase Grafana Dashboard to visualize over 200 database performance and health metrics on your Supabase project."}),(0,r.jsx)(ew,{className:"xl:hidden","data-sentry-element":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx"})]})]});var eN=a(61642);let eS=e=>[{id:"ram_usage",label:"Memory usage",hide:!1},{id:"avg_cpu_usage",label:"Average CPU usage",hide:!1},{id:"max_cpu_usage",label:"Max CPU usage",hide:!1},{id:"disk_iops_write",label:"Disk IOps write",hide:!1},{id:"disk_iops_read",label:"Disk IOps read",hide:!1},{id:"pg_stat_database_num_backends",label:"Pooler to database connections",hide:!1},{id:"supavisor_connections_active",label:"Client to Shared Pooler connections",hide:!1},{id:"client_connections_pgbouncer",label:"Client to Dedicated Pooler connections",hide:e}],eI=(e,t)=>{var a;let r=(null==e||null==(a=e.plan)?void 0:a.id)==="free",s=(null==t?void 0:t.infra_compute_size)||"medium",i=(null==e?void 0:e.plan.id)!=="free"&&!(null==e?void 0:e.usage_billing_enabled)&&(null==t?void 0:t.cloud_provider)!=="FLY";return[{id:"ram-usage",label:"Memory usage",hide:!1,showTooltip:!0,showLegend:!0,hideChartType:!1,defaultChartStyle:"line",showMaxValue:!0,showGrid:!0,syncId:"database-reports",valuePrecision:2,YAxisProps:{width:60,tickFormatter:e=>(0,en.z3)(e,2)},attributes:[{attribute:"ram_usage_used",provider:"infra-monitoring",label:"Used",tooltip:"Total RAM currently in use by the system and applications. High usage may indicate memory pressure."},{attribute:"ram_usage_cache_and_buffers",provider:"infra-monitoring",label:"Cache + buffers",tooltip:"RAM used for caching and buffering disk operations. Higher values improve read performance."},{attribute:"ram_usage_free",provider:"infra-monitoring",label:"Free",tooltip:"Available unused RAM. A small amount is always reserved. High unused RAM present with erratic Used RAM may indicate unoptimized queries disrupting cache."},{attribute:"ram_usage_swap",provider:"infra-monitoring",label:"Swap",omitFromTotal:!1,tooltip:"Memory swapped to disk when RAM is full. An instance has 1GB of SWAP. High swap with high disk I/O signals memory stress."},{attribute:"ram_usage_total",provider:"infra-monitoring",label:"Max",isMaxValue:!0,tooltip:"Total RAM"}]},{id:"cpu-usage",label:"CPU usage",syncId:"database-reports",format:"%",valuePrecision:2,hide:!1,showTooltip:!0,showLegend:!0,showMaxValue:!1,showGrid:!0,YAxisProps:{width:45,tickFormatter:e=>"".concat((0,el.Eg)(e,2),"%")},hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"cpu_usage_busy_system",provider:"infra-monitoring",label:"System",format:"%",tooltip:"CPU time spent on kernel operations (e.g., process scheduling, memory management). High values may indicate system overhead."},{attribute:"cpu_usage_busy_user",provider:"infra-monitoring",label:"User",format:"%",tooltip:"CPU time used by database queries and user-space processes. High values may suggest CPU-intensive queries."},{attribute:"cpu_usage_busy_iowait",provider:"infra-monitoring",label:"IOwait",format:"%",tooltip:"CPU time waiting for disk or network I/O. High values may indicate disk bottlenecks."},{attribute:"cpu_usage_busy_irqs",provider:"infra-monitoring",label:"IRQs",format:"%",tooltip:"CPU time handling hardware interrupt requests (IRQ)"},{attribute:"cpu_usage_busy_other",provider:"infra-monitoring",label:"Other",format:"%",tooltip:"CPU time spent on other tasks (e.g., background processes, software interrupts)."},{attribute:"cpu_usage_max",provider:"reference-line",label:"Max",value:100,tooltip:"Max CPU usage",isMaxValue:!0}]},{id:"disk-iops",label:"Disk IOps",syncId:"database-reports",hide:!1,showTooltip:!0,valuePrecision:2,showLegend:!0,hideChartType:!1,showGrid:!0,showMaxValue:!0,YAxisProps:{width:35,tickFormatter:e=>(0,el.Eg)(e,2)},defaultChartStyle:"line",docsUrl:"https://supabase.com/docs/guides/platform/compute-and-disk#compute-size",attributes:[{attribute:"disk_iops_write",provider:"infra-monitoring",label:"IOps write/s",tooltip:"Number of write operations per second. High values indicate frequent data writes, logging, or transaction activity."},{attribute:"disk_iops_read",provider:"infra-monitoring",label:"IOps read/s",tooltip:"Number of read operations per second. High values suggest frequent disk reads due to queries or poor caching."},{attribute:"disk_iops_max",provider:"reference-line",label:"Max IOPS",value:eP(s),tooltip:"Maximum IOPS (Input/Output Operations Per Second) for your current compute size",isMaxValue:!0}]},{id:"disk-io-usage",label:"Disk IO Usage",syncId:"database-reports",hide:!1,showTooltip:!0,format:"%",valuePrecision:6,showLegend:!1,showMaxValue:!1,hideChartType:!1,showGrid:!0,YAxisProps:{width:70,tickFormatter:e=>"".concat((0,el.Eg)(e,6),"%")},defaultChartStyle:"line",attributes:[{attribute:"disk_io_usage",provider:"infra-monitoring",label:"IO Usage",tooltip:"The actual number of IO operations per second that the database is currently using."}]},{id:"db-size",label:"Database Size",syncId:"database-reports",valuePrecision:2,hide:!1,showTooltip:!0,showLegend:!0,showMaxValue:!0,showGrid:!0,YAxisProps:{width:65,tickFormatter:e=>(0,en.z3)(e,1)},hideChartType:!1,defaultChartStyle:"line",docsUrl:"https://supabase.com/docs/guides/platform/database-size",attributes:[{attribute:"pg_database_size",provider:"infra-monitoring",label:"Database",tooltip:"Total space on disk used by your database (tables, indexes, data, ...)."},{attribute:"max_pg_database_size",provider:"reference-line",label:"Disk size",value:1024*((null==t?void 0:t.volumeSizeGb)||eM(s))*1048576,tooltip:"Disk Size refers to the total space your project occupies on disk",isMaxValue:!0},!r&&(i?{attribute:"pg_database_size_percent_paid_spendCap",provider:"reference-line",isReferenceLine:!0,strokeDasharray:"4 2",label:"Spend cap enabled",value:1024*((null==t?void 0:t.volumeSizeGb)||eM(s))*1048576,className:"[&_line]:!stroke-yellow-800 [&_line]:!opacity-100",opacity:1}:{attribute:"pg_database_size_percent_paid",provider:"reference-line",isReferenceLine:!0,label:"90% - Disk resize threshold",className:"[&_line]:!stroke-yellow-800",value:1024*((null==t?void 0:t.volumeSizeGb)||eM(s))*943718.4})]},{id:"network-traffic",label:"Network Traffic",syncId:"database-reports",valuePrecision:1,showTooltip:!0,showLegend:!0,showMaxValue:!1,showGrid:!0,YAxisProps:{width:65,tickFormatter:e=>(0,en.z3)(e,1)},hideChartType:!1,defaultChartStyle:"line",hideHighlightedValue:!0,showTotal:!1,attributes:[{attribute:"network_transmit_bytes",provider:"infra-monitoring",label:"Transmit",tooltip:"Data sent from your database to clients. High values may indicate large query results or numerous outgoing connections.",stackId:"2"},{attribute:"network_receive_bytes",provider:"infra-monitoring",label:"Receive",tooltip:"Data received by your database from clients. High values may indicate frequent queries, large data inserts, or many incoming connections.",stackId:"1"}]},{id:"client-connections",label:"Database client connections",valuePrecision:0,hide:!1,showTooltip:!0,showLegend:!0,showMaxValue:!0,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"client_connections_postgres",provider:"infra-monitoring",label:"postgres",tooltip:"Active connections"},{attribute:"client_connections_authenticator",provider:"infra-monitoring",label:"postgrest",tooltip:"Active connections"},{attribute:"client_connections_supabase_auth_admin",provider:"infra-monitoring",label:"auth",tooltip:"Active connections"},{attribute:"client_connections_supabase_storage_admin",provider:"infra-monitoring",label:"storage",tooltip:"Active connections"},{attribute:"client_connections_supabase_admin",provider:"infra-monitoring",label:"supabase-admin",tooltip:"Active connections"},{attribute:"client_connections_other",provider:"infra-monitoring",label:"other",tooltip:"Active connections"},{attribute:"max_db_connections",provider:"infra-monitoring",label:"Maximum connections allowed",tooltip:"Maximum connections for instance size",isMaxValue:!0}]},{id:"pgbouncer-connections",label:"Pooler client connections",syncId:"database-reports",valuePrecision:0,hide:!1,showTooltip:!0,showLegend:!0,showMaxValue:!0,showGrid:!0,YAxisProps:{width:30},hideChartType:!1,defaultChartStyle:"line",docsUrl:"https://supabase.com/docs/guides/platform/compute-and-disk#limits-and-constraints",attributes:[{attribute:"client_connections_pgbouncer",provider:"infra-monitoring",label:"pgbouncer",tooltip:"PgBouncer connections"},{attribute:"pg_pooler_max_connections",provider:"reference-line",label:"Max pooler connections",value:eE(s).pooler,tooltip:"Maximum allowed pooler connections for your current compute size",isMaxValue:!0}]},{id:"supavisor-connections-active",label:"Supavisor client connections",syncId:"database-reports",valuePrecision:0,hide:r,showTooltip:!1,showLegend:!1,showMaxValue:!1,showGrid:!0,YAxisProps:{width:30},hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"supavisor_connections_active",provider:"infra-monitoring",label:"supavisor",tooltip:"Supavisor connections"}]}]},eE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium",t={nano:{direct:60,pooler:200},micro:{direct:60,pooler:200},small:{direct:90,pooler:400},medium:{direct:120,pooler:600},large:{direct:160,pooler:800},xl:{direct:240,pooler:1e3},"2xl":{direct:380,pooler:1500},"4xl":{direct:480,pooler:3e3},"8xl":{direct:490,pooler:6e3},"12xl":{direct:500,pooler:9e3},"16xl":{direct:500,pooler:12e3}};return t[null==e?void 0:e.toLowerCase()]||t.medium},eP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium",t={nano:250,micro:500,small:1e3,medium:2e3,large:3600,xl:6e3,"2xl":12e3,"4xl":2e4,"8xl":4e4,"12xl":5e4,"16xl":8e4};return t[null==e?void 0:e.toLowerCase()]||t.medium},eM=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium",t={nano:.5,micro:10,small:50,medium:100,large:200,xl:500,"2xl":1024,"4xl":2048,"8xl":4096,"12xl":6144,"16xl":10240};return t[null==e?void 0:e.toLowerCase()]||t.medium};var eD=a(49457),eT=a(11164),eR=a(6885);let eL=()=>{let{ref:e}=(0,x.g)(),t=(0,eR.B)(eT.NY.database.queries,null!=e?e:"default").largeObjects(),a=[t].some(e=>e.isLoading);return{data:{largeObjects:t.data},errors:{largeObjects:t.error},params:{largeObjects:t.params},largeObjectsSql:t.resolvedSql,isLoading:a,refresh:()=>t.runQuery}};var ez=a(33974),eO=a(77227),eq=a(77525),eG=a(74725),eH=a(56686);let eB=()=>(0,r.jsx)(v.A,{"data-sentry-element":"ReportPadding","data-sentry-component":"DatabaseReport","data-sentry-source-file":"database.tsx",children:(0,r.jsx)(eF,{"data-sentry-element":"DatabaseUsage","data-sentry-source-file":"database.tsx"})});eB.getLayout=e=>(0,r.jsx)(j.A,{children:(0,r.jsx)(k.A,{title:"Database",children:e})});let eU=eB,eF=()=>{var e,t,a;let{db:n,chart:m,ref:v}=(0,x.g)(),{project:j}=(0,A.Om)(),k=(0,eG._)("reportsDatabaseV2"),N=(0,eA.a)(),{plan:S,isLoading:I}=(0,eq.c)(),E=!I&&(null==S?void 0:S.id)==="free",P=(0,L.RE)(),M=o()().subtract(1,"day").toISOString(),D=o()().toISOString(),[T,R]=(0,s.useState)({period_start:{date:M,time_period:"1d"},period_end:{date:D,time_period:"today"},interval:"1h"}),z=(0,l.jE)(),[H,B]=(0,s.useState)(!1),U=P.selectedDatabaseId!==(null==j?void 0:j.ref),F=eL(),{data:V,params:K,largeObjectsSql:X,isLoading:Y,refresh:W}=F,{data:Q}=(0,eD.Gw)({projectRef:null==j?void 0:j.ref,connectionString:(null==j?void 0:j.connectionString)||void 0}),$=null!=Q?Q:0,Z=null!=(a=null==j?void 0:j.volumeSizeGb)?a:0,[J,ee]=(0,s.useState)(!1),et=(0,eO.SE)(i.aG.UPDATE,"projects",{resource:{project_id:null==j?void 0:j.id}}),ea=eS(E),er=eI(N,j),{isLoading:es}=(0,ez.F)({onSuccess:(e,t)=>{h.oR.success("Successfully updated disk size to ".concat(t.volumeSize," GB")),ee(!1)}}),ei=async()=>{if(!T)return;B(!0),W();let{period_start:e,interval:t}=T;ea.forEach(a=>{z.invalidateQueries(eN.P.infraMonitoring(v,{attribute:null==a?void 0:a.id,startDate:e.date,endDate:e.end,interval:t,databaseIdentifier:P.selectedDatabaseId}))}),k&&er.forEach(a=>{a.attributes.forEach(a=>{z.invalidateQueries(eN.P.infraMonitoring(v,{attribute:a.attribute,startDate:e.date,endDate:e.end,interval:t,databaseIdentifier:P.selectedDatabaseId}))})}),U&&z.invalidateQueries(eN.P.infraMonitoring(v,{attribute:"physical_replication_lag_physical_replica_lag_seconds",startDate:e.date,endDate:e.end,interval:t,databaseIdentifier:P.selectedDatabaseId})),setTimeout(()=>B(!1),1e3)};(0,s.useEffect)(()=>{void 0!==n&&setTimeout(()=>{P.setSelectedDatabaseId(n)},100),void 0!==m&&setTimeout(()=>{let e=document.getElementById(m);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},200)},[n,m]);let el=(e,t)=>{let a={"1m":3>o()(t).diff(e,"hour"),"10m":6>o()(t).diff(e,"hour"),"30m":18>o()(t).diff(e,"hour"),"1h":10>o()(t).diff(e,"day"),"1d":o()(t).diff(e,"day")>=10};switch(!0){case a["1m"]:return"1m";case a["10m"]:return"10m";case a["30m"]:return"30m";default:return"1h"}},eo=(e,t)=>{R({period_start:{date:e,time_period:"1d"},period_end:{date:t,time_period:"today"},interval:el(e,t)})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{showDatabaseSelector:!0,title:"Database","data-sentry-element":"ReportHeader","data-sentry-source-file":"database.tsx"}),(0,r.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,r.jsx)("div",{className:"h-2 w-full",children:(0,r.jsx)(G.A,{active:F.isLoading,"data-sentry-element":"ShimmerLine","data-sentry-source-file":"database.tsx"})})}),(0,r.jsx)(eC,{"data-sentry-element":"GrafanaPromoBanner","data-sentry-source-file":"database.tsx"}),(0,r.jsxs)("section",{className:"relative pt-16 -mt-2",children:[(0,r.jsx)("div",{className:"absolute inset-0 z-40 pointer-events-none flex flex-col gap-4",children:(0,r.jsxs)("div",{className:"sticky top-0 bg-200 py-4 mb-4 flex items-center space-x-3 pointer-events-auto",children:[(0,r.jsx)(C.G,{type:"default",disabled:H,icon:(0,r.jsx)(d.A,{className:H?"animate-spin":""}),className:"w-7",tooltip:{content:{side:"bottom",text:"Refresh report"}},onClick:ei,"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"database.tsx"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(eb.U,{loading:!1,value:"1d",options:eH.QP,currentBillingPeriodStart:void 0,onChange:e=>{"1d"===e.interval?R({...e,interval:"1h"}):R(e)},"data-sentry-element":"DateRangePicker","data-sentry-source-file":"database.tsx"}),T&&(0,r.jsxs)("div",{className:"flex items-center gap-x-2 text-xs",children:[(0,r.jsx)("p",{className:"text-foreground-light",children:o()(T.period_start.date).format("MMM D, h:mma")}),(0,r.jsx)("p",{className:"text-foreground-light",children:(0,r.jsx)(c.A,{size:12})}),(0,r.jsx)("p",{className:"text-foreground-light",children:o()(T.period_end.date).format("MMM D, h:mma")})]})]})]})}),k?(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4",children:T&&er.filter(e=>!e.hide).map(e=>{var t,a;return(0,r.jsx)(ev,{...e,attributes:e.attributes,interval:T.interval,startDate:null==T||null==(t=T.period_start)?void 0:t.date,endDate:null==T||null==(a=T.period_end)?void 0:a.date,updateDateRange:eo,defaultChartStyle:e.defaultChartStyle,showMaxValue:"client-connections"===e.id||"pgbouncer-connections"===e.id||e.showMaxValue},e.id)})}):(0,r.jsx)(q.A,{title:(0,r.jsx)("h2",{children:"Database health"}),children:(0,r.jsx)(q.A.Content,{className:"grid grid-cols-1 gap-4",children:T&&ea.filter(e=>!e.hide).map(e=>{var t,a;return(0,r.jsx)(O,{...e,provider:"infra-monitoring",attribute:e.id,label:e.label,interval:T.interval,startDate:null==T||null==(t=T.period_start)?void 0:t.date,endDate:null==T||null==(a=T.period_end)?void 0:a.date},e.id)})})}),T&&U&&(0,r.jsx)(q.A,{title:"Replica Information",children:(0,r.jsx)(q.A.Content,{children:(0,r.jsx)("div",{id:"replication-lag",children:(0,r.jsx)(O,{startDate:null==T||null==(e=T.period_start)?void 0:e.date,endDate:null==T||null==(t=T.period_end)?void 0:t.date,attribute:"physical_replication_lag_physical_replica_lag_seconds",label:"Replication lag",interval:T.interval,provider:"infra-monitoring"})})})})]}),(0,r.jsxs)("section",{id:"database-size-report",children:[(0,r.jsx)(b.A,{isLoading:Y,params:K.largeObjects,title:"Database Size",data:V.largeObjects||[],queryType:"db",resolvedSql:X,renderer:e=>{var t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"col-span-4 inline-grid grid-cols-12 gap-12 w-full mt-5",children:[(0,r.jsxs)("div",{className:"grid gap-2 col-span-4 xl:col-span-2",children:[(0,r.jsx)("h5",{className:"text-sm",children:"Space used"}),(0,r.jsx)("span",{className:"text-lg",children:(0,en.z3)($,2,"GB")})]}),(0,r.jsxs)("div",{className:"grid gap-2 col-span-4 xl:col-span-3",children:[(0,r.jsx)("h5",{className:"text-sm",children:"Provisioned disk size"}),(0,r.jsxs)("span",{className:"text-lg",children:[Z," GB"]})]}),(0,r.jsx)("div",{className:"col-span-full lg:col-span-4 xl:col-span-7 lg:text-right",children:(null==j?void 0:j.cloud_provider)==="AWS"?(0,r.jsx)(g.$,{asChild:!0,type:"default",children:(0,r.jsx)(p(),{href:"/project/".concat(v,"/settings/compute-and-disk"),children:"Increase disk size"})}):(0,r.jsx)(C.G,{type:"default",disabled:!et,onClick:()=>ee(!0),tooltip:{content:{side:"bottom",text:et?void 0:"You need additional permissions to increase the disk size"}},children:"Increase disk size"})})]}),(0,r.jsx)("h3",{className:"mt-8 text-sm",children:"Large Objects"}),!e.isLoading&&0===e.data.length&&(0,r.jsx)("span",{children:"No large objects found"}),!e.isLoading&&e.data.length>0&&(0,r.jsx)(w.A,{className:"space-y-3 mt-4",head:[(0,r.jsx)(w.A.th,{className:"py-2",children:"Object"},"object"),(0,r.jsx)(w.A.th,{className:"py-2",children:"Size"},"size")],body:null==(t=e.data)?void 0:t.map(e=>{let t=(e.table_size/$*100).toFixed(2);return(0,r.jsxs)(w.A.tr,{children:[(0,r.jsxs)(w.A.td,{children:[e.schema_name,".",e.relname]}),(0,r.jsxs)(w.A.td,{children:[(0,en.z3)(e.table_size)," (",t,"%)"]})]},"".concat(e.schema_name,".").concat(e.relname))})})]})},append:()=>(0,r.jsx)("div",{className:"px-6 pb-6",children:(0,r.jsx)(f.Fc,{variant:"default",className:"mt-4",children:(0,r.jsx)(f.TN,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{children:"New Supabase projects have a database size of ~40-60mb. This space includes pre-installed extensions, schemas, and default Postgres data. Additional database size is used when installing extensions, even if those extensions are inactive."}),(0,r.jsx)(g.$,{asChild:!0,type:"default",icon:(0,r.jsx)(u.A,{}),children:(0,r.jsx)(p(),{href:"https://supabase.com/docs/guides/platform/database-size#disk-space-usage",target:"_blank",rel:"noreferrer",children:"Read about database size"})})]})})})}),"data-sentry-element":"ReportWidget","data-sentry-source-file":"database.tsx"}),(0,r.jsx)(_.A,{visible:J,loading:es,hideModal:ee,"data-sentry-element":"DiskSizeConfigurationModal","data-sentry-source-file":"database.tsx"})]})]})}},33446:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(23983).A)("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]])},33974:(e,t,a)=>{"use strict";a.d(t,{F:()=>d});var r=a(32144),s=a(80251),i=a(73969),l=a(40807),n=a(76191);async function o(e){let{projectRef:t,volumeSize:a}=e;if(!t)throw Error("projectRef is required");let{data:r,error:s}=await (0,l.bE)("/platform/projects/{ref}/resize",{params:{path:{ref:t}},body:{volume_size_gb:a}});return s&&(0,l.H4)(s),r}let d=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,r.jE)();return(0,s.n)(e=>o(e),{async onSuccess(t,a,r){let{projectRef:s}=a;l.setQueriesData(n.E.usage(s),e=>e?{...e,disk_volume_size_gb:a.volumeSize}:e),await (null==e?void 0:e(t,a,r))},async onError(e,a,r){void 0===t?i.oR.error("Failed to resize project disk: ".concat(e.message)):t(e,a,r)},...a})}},48806:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(23983).A)("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]])},49457:(e,t,a)=>{"use strict";a.d(t,{Gw:()=>o});var r=a(56947),s=a(96557),i=a(95059);let l=()=>"\nselect sum(pg_database_size(pg_database.datname))::bigint as db_size from pg_database;\n".trim();async function n(e,t){var a;let{projectRef:r,connectionString:i}=e,n=l(),{result:o}=await (0,s.E)({projectRef:r,connectionString:i,sql:n,queryKey:["database-size"]},t),d=null==o||null==(a=o[0])?void 0:a.db_size;if("number"!=typeof d)throw Error("Error fetching dbSize");return d}let o=function(e){let{projectRef:t,connectionString:a}=e,{enabled:s=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.I)(i.c.databaseSize(t),e=>{let{signal:r}=e;return n({projectRef:t,connectionString:a},r)},{enabled:s&&void 0!==t,...l})}},56686:(e,t,a)=>{"use strict";a.d(t,{Cb:()=>c,L3:()=>u,PJ:()=>m,QP:()=>p,wG:()=>d});var r=a(80263),s=a(57210),i=a(64452),l=a(34048),n=a(94715),o=a(70994);let d={API:{label:"All API usage",icon:e=>(0,r.jsx)(i.A,{size:16,className:e}),key:"api"},API_DATABASE:{label:"Database API",icon:e=>(0,r.jsx)(l.A,{size:16,className:e}),key:"api_database"},API_AUTH:{label:"Authentication",icon:e=>(0,r.jsx)(s.Nj,{size:16,className:e}),key:"api_auth"},API_STORAGE:{label:"Storage",icon:e=>(0,r.jsx)(s.wc,{size:16,className:e}),key:"api_storage"},API_REALTIME:{label:"Realtime",icon:e=>(0,r.jsx)(s.Se,{size:16,className:e}),key:"api_realtime"},INSTANCE:{label:"Instance health",icon:e=>(0,r.jsx)(n.A,{size:16,className:e}),key:"instance"},SUPAVISOR:{label:"Supavisor",icon:e=>(0,r.jsx)(o.A,{size:16,className:e}),key:"supavisor"}},c=[{key:"avg_cpu_usage",label:"Average CPU % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"max_cpu_usage",label:"Max CPU % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"disk_io_consumption",label:"Disk IO % Consumed",provider:"infra-monitoring",category:d.INSTANCE},{key:"disk_io_budget",label:"Disk IO % Remaining",provider:"infra-monitoring",category:d.INSTANCE},{key:"ram_usage",label:"Memory % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"total_realtime_egress",label:"Realtime Connection Egress",provider:"daily-stats",category:d.API},{key:"total_realtime_requests",label:"Realtime Connection Requests",provider:"daily-stats",category:d.API_REALTIME},{key:"total_realtime_ingress",label:"Realtime Connection Ingress",provider:"daily-stats",category:d.API_REALTIME},{key:"total_rest_ingress",label:"API Ingress",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_egress",label:"API Egress",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_requests",label:"API Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_get_requests",label:"API GET Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_post_requests",label:"API POST Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_patch_requests",label:"API PATCH Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_delete_requests",label:"API DELETE Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_options_requests",label:"API OPTIONS Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_auth_billing_period_mau",label:"Auth Monthly Active User",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_billing_period_sso_mau",label:"Auth Monthly Active SSO User",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_ingress",label:"Auth Ingress",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_egress",label:"Auth Egress",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_requests",label:"Auth Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_get_requests",label:"Auth GET Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_post_requests",label:"Auth POST Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_patch_requests",label:"Auth PATCH Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_options_requests",label:"Auth OPTIONS Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_storage_ingress",label:"Storage Ingress",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_egress",label:"Storage Egress",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_image_render_count",label:"Storage Image Transformations",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_requests",label:"Storage Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_get_requests",label:"Storage GET Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_post_requests",label:"Storage POST Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_delete_requests",label:"Storage DELETE Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_options_requests",label:"Storage OPTIONS Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_auth_delete_requests",label:"Auth DELETE Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_egress",label:"All Egress",provider:"daily-stats",category:d.API},{key:"total_get_requests",label:"All GET Requests",provider:"daily-stats",category:d.API},{key:"total_storage_patch_requests",label:"Storage PATCH Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_requests",label:"All Requests",provider:"daily-stats",category:d.API},{key:"total_patch_requests",label:"All PATCH Requests",provider:"daily-stats",category:d.API},{key:"total_post_requests",label:"All POST Requests",provider:"daily-stats",category:d.API},{key:"total_ingress",label:"All Ingress",provider:"daily-stats",category:d.API},{key:"total_delete_requests",label:"All DELETE Requests",provider:"daily-stats",category:d.API},{key:"total_options_requests",label:"All OPTIONS Requests",provider:"daily-stats",category:d.API},{key:"total_supavisor_egress_bytes",label:"Shared Pooler Egress",provider:"daily-stats",category:d.SUPAVISOR}],u=[{key:"currentBillingCycle",label:"Current billing cycle",interval:"1d"},{key:"previousBillingCycle",label:"Previous billing cycle",interval:"1d"}],m=[{key:"7d",label:"Last 7 days",interval:"1d"},{key:"30d",label:"Last 30 days",interval:"1d"},{key:"startMonth",label:"This month",interval:"1d"}],p=[{key:"10m",label:"Last 10 minutes"},{key:"30m",label:"Last 30 minutes"},{key:"1h",label:"Last hour"},{key:"3h",label:"Last 3 hours"},{key:"1d",label:"Last 24 hours"},{key:"7d",label:"Last 7 days"}]},61068:(e,t,a)=>{"use strict";a.d(t,{A:()=>v});var r=a(80263),s=a(53239),i=a(53434),l=a.n(i),n=a(62761),o=a(14984),d=a(11722),c=a(69838),u=a(52185),m=a(49911),p=a(30381),h=a(32199),g=a(54650),f=a(73896),x=a(72883),y=a(3283);let v=e=>{var t,a,i;let{data:v,yAxisKey:b,xAxisKey:_,format:j,customDateFormat:A=g.C_.FULL,title:k,highlightedValue:w,highlightedLabel:C,displayDateInUtc:N,minimalHeader:S,valuePrecision:I,className:E="",size:P="normal",emptyStateMessage:M,onBarClick:D,showLegend:T=!1,xAxisIsDate:R=!0,XAxisProps:L,YAxisProps:z,showGrid:O=!1}=e,{Container:q}=(0,x.dQ)(P),[G,H]=(0,s.useState)(null),B=(0,s.useMemo)(()=>v.map(e=>({...e,[b]:"string"==typeof e[b]?Number(e[b]):e[b]})),[v,b]),U=L||{interval:v.length-2,angle:0,tick:!1},F=z||{tickFormatter:e=>(0,x.Eg)(e,I),tick:!1,width:0},V=e=>N?l()(e).utc():l()(e),K=function(){if(!R){var e;return G?null==(e=v[G])?void 0:e[_]:C}return null!==G&&v&&void 0!==v[G]&&V(v[G][_]).format(A)||C}(),X=null!==G?null==(t=v[G])?void 0:t[b]:w;return 0===v.length?(0,r.jsx)(y.A,{message:M,description:"It may take up to 24 hours for data to refresh",size:P,className:E,attribute:k,format:j}):(0,r.jsxs)("div",{className:["flex flex-col gap-y-3",E].join(" "),"data-sentry-component":"BarChart","data-sentry-source-file":"BarChart.tsx",children:[(0,r.jsx)(f.A,{title:k,format:j,customDateFormat:A,highlightedValue:"number"==typeof X?(0,x.Eg)(X,I):X,highlightedLabel:K,minimalHeader:S,"data-sentry-element":"ChartHeader","data-sentry-source-file":"BarChart.tsx"}),(0,r.jsx)(q,{"data-sentry-element":"Container","data-sentry-source-file":"BarChart.tsx",children:(0,r.jsxs)(n.E,{data:B,className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==G&&H(e.activeTooltipIndex)},onMouseLeave:()=>H(null),onClick:e=>{var t,a;let r=null==e||null==(a=e.activePayload)||null==(t=a[0])?void 0:t.payload;D&&D(r,e)},"data-sentry-element":"RechartBarChart","data-sentry-source-file":"BarChart.tsx",children:[T&&(0,r.jsx)(o.s,{}),O&&(0,r.jsx)(d.d,{stroke:g.OK.AXIS}),(0,s.createElement)(c.h,{...F,axisLine:{stroke:g.OK.AXIS},tickLine:{stroke:g.OK.AXIS},key:b,"data-sentry-element":"YAxis","data-sentry-source-file":"BarChart.tsx"}),(0,s.createElement)(u.W,{...U,axisLine:{stroke:g.OK.AXIS},tickLine:{stroke:g.OK.AXIS},key:_,"data-sentry-element":"XAxis","data-sentry-source-file":"BarChart.tsx"}),(0,r.jsx)(m.m,{content:()=>null,"data-sentry-element":"Tooltip","data-sentry-source-file":"BarChart.tsx"}),(0,r.jsx)(p.y,{dataKey:b,fill:g.OK.GREEN_1,animationDuration:300,maxBarSize:48,"data-sentry-element":"Bar","data-sentry-source-file":"BarChart.tsx",children:null==v?void 0:v.map((e,t)=>(0,r.jsx)(h.f,{className:"transition-all duration-300 ".concat(D?"cursor-pointer":""),fill:G===t||null===G?g.OK.GREEN_1:g.OK.GREEN_2,enableBackground:12},"cell-".concat(t)))})]})}),v&&(0,r.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{children:R?V(v[0][_]).format(A):v[0][_]}),(0,r.jsx)("span",{children:R?V(null==(a=v[(null==v?void 0:v.length)-1])?void 0:a[_]).format(A):null==(i=v[(null==v?void 0:v.length)-1])?void 0:i[_]})]})]})}},61642:(e,t,a)=>{"use strict";a.d(t,{P:()=>r});let r={warehouseQuery:(e,t)=>["projects",e,"warehouse","query",t],warehouseTenant:e=>["projects",e,"warehouse","tenant"],warehouseCollections:e=>["projects",e,"warehouse","collections"],warehouseCollectionsCreate:e=>["projects",e,"warehouse","collections","create"],warehouseEndpoints:e=>["projects",e,"warehouse","endpoints"],warehouseBackends:e=>["projects",e,"warehouse","backends"],warehouseAccessTokens:e=>["projects",e,"warehouse","access-tokens"],functionsInvStats:(e,t)=>{let{interval:a,functionId:r}=t;return["projects",e,"functions-inv-stats",{interval:a,functionId:r}]},functionsReqStats:(e,t)=>{let{interval:a,functionId:r}=t;return["projects",e,"functions-req-stats",{interval:a,functionId:r}]},functionsResourceUsage:(e,t)=>{let{interval:a,functionId:r}=t;return["projects",e,"functions-resource-usage",{interval:a,functionId:r}]},orgDailyComputeStats:(e,t)=>{let{startDate:a,endDate:r,projectRef:i}=t;return["organizations",e,"daily-stats-compute",{startDate:s(a),endDate:s(r),projectRef:i}]},orgDailyStats:(e,t)=>{let{metric:a,startDate:r,endDate:i,interval:l,projectRef:n}=t;return["organizations",e,"daily-stats",{metric:a,startDate:s(r),endDate:s(i),interval:l,projectRef:n}]},infraMonitoring:(e,t)=>{let{attribute:a,startDate:r,endDate:s,interval:i,databaseIdentifier:l}=t;return["projects",e,"infra-monitoring",{attribute:a,startDate:r,endDate:s,interval:i,databaseIdentifier:l}]},usageApiCounts:(e,t)=>["projects",e,"usage.api-counts",t],usageApiRequestsCount:e=>["projects",e,"usage.api-requests-count"]};function s(e){return e?e.split("T")[0]:e}},65961:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var r=a(80263),s=a(87959),i=a(77877),l=a(47504),n=a(19898),o=a(21889),d=a(51859),c=a(16632),u=a(71126),m=a(25424);let p=e=>{let t=(0,l.useRouter)(),{ref:a}=(0,n.g)();return(0,r.jsxs)(o.A,{noMargin:!0,noHideOverflow:!0,className:(0,d.cn)("pb-0",e.className),wrapWithLoading:!1,"data-sentry-element":"Panel","data-sentry-component":"ReportWidget","data-sentry-source-file":"ReportWidget.tsx",children:[(0,r.jsxs)(o.A.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"ReportWidget.tsx",children:[(0,r.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,r.jsxs)("div",{className:"gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,r.jsx)("h3",{className:"w-full h-6",children:e.title})," ",(null==e?void 0:e.tooltip)&&(0,r.jsxs)(c.m_,{children:[(0,r.jsx)(c.k$,{children:(0,r.jsx)(s.A,{className:"text-foreground-light",size:14,strokeWidth:1.5})}),(0,r.jsx)(c.ZI,{side:"bottom",children:e.tooltip})]})]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:e.description})]}),e.params&&(0,r.jsxs)(c.m_,{children:[(0,r.jsx)(c.k$,{asChild:!0,children:(0,r.jsx)(u.$,{type:"default",icon:(0,r.jsx)(i.A,{}),className:"px-1",onClick:()=>{let r="db"===e.queryType,s=r?"/project/".concat(a,"/sql/new"):"/project/".concat(a,"/logs/explorer"),i={};if(r)i.content=e.resolvedSql;else{var l;i.q=null==(l=e.params)?void 0:l.sql,i.its=e.params.iso_timestamp_start,i.ite=e.params.iso_timestamp_end}t.push({pathname:s,query:i})}})}),(0,r.jsx)(c.ZI,{side:"left",children:"db"===e.queryType?"Open in SQL Editor":"Open in Logs Explorer"})]})]}),(0,r.jsx)(m.A,{active:e.isLoading,"data-sentry-element":"Loading","data-sentry-source-file":"ReportWidget.tsx",children:void 0===e.data?null:e.renderer({...e,router:t,projectRef:a})})]}),e.append&&(0,r.jsx)(r.Fragment,{children:e.append({...e,...e.appendProps||{},router:t,projectRef:a})})]})}},66880:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var r=a(56947),s=a(11164),i=a(97872),l=a(61428),n=a(96557),o=a(51626);let d=e=>{var t;let{sql:a,params:d=s.EV,where:c,orderBy:u}=e,{project:m}=(0,i.Om)(),p=(0,o.RE)(),{data:h}=(0,l.Vh)({projectRef:null==m?void 0:m.ref}),g=null==(t=(h||[]).find(e=>e.identifier===p.selectedDatabaseId))?void 0:t.connectionString,f=p.selectedDatabaseId,x="function"==typeof a?a([]):a,{data:y,error:v,isLoading:b,isRefetching:_,refetch:j}=(0,r.I)(["projects",null==m?void 0:m.ref,"db",{...d,sql:x,identifier:f},c,u],e=>{let{signal:t}=e;return(0,n.E)({projectRef:null==m?void 0:m.ref,connectionString:g||(null==m?void 0:m.connectionString),sql:x},t).then(e=>e.result)},{enabled:!!x,refetchOnWindowFocus:!1,refetchOnReconnect:!1});return{error:v||("object"==typeof y?null==y?void 0:y.error:""),data:y,isLoading:b,isRefetching:_,params:d,runQuery:j,resolvedSql:x}}},69368:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(23983).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},77525:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var r=a(34969);function s(){let e=(0,r.a)();return e?{plan:null==e?void 0:e.plan,usageBillingEnabled:null==e?void 0:e.usage_billing_enabled,isLoading:!1,isSuccess:!0}:{plan:null,usageBillingEnabled:null,isLoading:!0,isSuccess:!1}}},84381:(e,t,a)=>{"use strict";a.d(t,{Q:()=>o});var r=a(88725),s=a(84909),i=a(52185),l=a(69838),n=a(63139),o=(0,r.gu)({chartName:"AreaChart",GraphicalChild:s.G,axisComponents:[{axisType:"xAxis",AxisComp:i.W},{axisType:"yAxis",AxisComp:l.h}],formatAxisMap:n.pr})},89452:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(56947),s=a(53434),i=a.n(s),l=a(40807),n=a(61642);async function o(e,t){let{projectRef:a,attribute:r,startDate:s,endDate:i,interval:n="1d",databaseIdentifier:o}=e;if(!a)throw Error("Project ref is required");if(!r)throw Error("Attribute is required");if(!s)throw Error("Start date is required");if(!i)throw Error("End date is required");let{data:d,error:c}=await (0,l.Jt)("/platform/projects/{ref}/daily-stats",{params:{path:{ref:a},query:{attribute:r,startDate:s,endDate:i,interval:n}},signal:t});return c&&(0,l.H4)(c),d}let d=function(e){let{projectRef:t,attribute:a,startDate:s,endDate:l,interval:d="1d",dateFormat:c="DD MMM",databaseIdentifier:u,modifier:m}=e,{enabled:p=!0,...h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.I)(n.P.infraMonitoring(t,{attribute:a,startDate:s,endDate:l,interval:d,databaseIdentifier:u}),e=>{let{signal:r}=e;return o({projectRef:t,attribute:a,startDate:s,endDate:l,interval:d,databaseIdentifier:u},r)},{enabled:p&&void 0!==t&&void 0!==a&&void 0!==s&&void 0!==l,select:e=>({...e,data:e.data.map(e=>({...e,[a]:void 0!==m?m(Number(e[a])):Number(e[a]),periodStartFormatted:i()(e.period_start).format(c)}))}),staleTime:6e4,...h})}},96246:(e,t,a)=>{"use strict";a.d(t,{A:()=>w});var r=a(80263),s=a(60045),i=a(53434),l=a.n(i),n=a(3073),o=a(77877),d=a(59153),c=a.n(d),u=a(73969),m=a(86692),p=a(19898),h=a(97872),g=a(33974),f=a(55345),x=a(34969),y=a(67920),v=a(66586),b=a(70324),_=a(83086),j=a(71126),A=a(13276),k=a(49655);let w=e=>{var t,a,i,d,w;let{visible:C,loading:N,hideModal:S}=e,{ref:I}=(0,p.g)(),{project:E,isLoading:P}=(0,h.Om)(),{lastDatabaseResizeAt:M}=null!=E?E:{},D=(0,x.a)(),{data:T,isLoading:R}=(0,f.j5)({orgSlug:null==D?void 0:D.slug},{enabled:C}),L=null===M?0:360-l()().diff(M,"minutes"),z=L<=0,O=L<60?"".concat(L," minute(s)"):"".concat(Math.floor(L/60)," hours and ").concat(L%60," minute(s)"),{mutate:q,isLoading:G}=(0,g.F)({onSuccess:(e,t)=>{u.oR.success("Successfully updated disk size to ".concat(t.volumeSize," GB")),S(!1)}}),H=async e=>{if(!I)return console.error("Project ref is required");q({projectRef:I,volumeSize:e["new-disk-size"]})},B=null!=(w=null==E?void 0:E.volumeSizeGb)?w:0,U=(0,m.object)({"new-disk-size":(0,m.number)().required("Please enter a GB amount you want to resize the disk up to.").min(Number(null!=B?B:0),"Must be more than ".concat(B," GB")).max(Number(200),"Must not be more than 200 GB")});return(0,r.jsx)(y.A,{header:"Increase Disk Storage Size",size:"medium",visible:C,loading:N,onCancel:()=>S(!1),hideFooter:!0,"data-sentry-element":"Modal","data-sentry-component":"DiskSizeConfigurationModal","data-sentry-source-file":"DiskSizeConfigurationModal.tsx",children:P||R?(0,r.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,r.jsx)(k.A,{}),(0,r.jsx)(k.A,{})]}):(null==T?void 0:T.usage_billing_enabled)===!0?(0,r.jsx)(v.A,{name:"disk-resize-form",initialValues:{"new-disk-size":B},validationSchema:U,onSubmit:H,children:()=>B>=200?(0,r.jsxs)(b.Fc,{variant:"warning",className:"rounded-t-none border-0",children:[(0,r.jsx)(_.id,{}),(0,r.jsx)(b.XL,{children:"Maximum manual disk size increase reached"}),(0,r.jsxs)(b.TN,{children:[(0,r.jsxs)("p",{children:["You cannot manually expand the disk size any more than ",200,"GB. If you need more than this, contact us via support for help."]}),(0,r.jsx)(j.$,{asChild:!0,type:"default",className:"mt-3",children:(0,r.jsx)(c(),{href:"/support/new?projectRef=".concat(I,"&category=").concat(s.S.PERFORMANCE_ISSUES,"&subject=Increase%20disk%20size%20beyond%20200GB"),children:"Contact support"})})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(y.A.Content,{className:"w-full space-y-4",children:[(0,r.jsxs)(b.Fc,{variant:z?"default":"warning",children:[(0,r.jsx)(n.A,{size:16}),(0,r.jsx)(b.XL,{children:"This operation is only possible every 6 hours"}),(0,r.jsxs)(b.TN,{children:[(0,r.jsx)("div",{className:"mb-4",children:z?"Upon updating your disk size, the next disk size update will only be available from ".concat(l()().format("DD MMM YYYY, HH:mm (ZZ)")):"Your database was last resized at ".concat(l()(M).format("DD MMM YYYY, HH:mm (ZZ)"),". You can resize your database again in approximately ").concat(O)}),(0,r.jsx)(j.$,{asChild:!0,type:"default",iconRight:(0,r.jsx)(o.A,{size:14}),children:(0,r.jsx)(c(),{href:"https://supabase.com/docs/guides/platform/database-size#disk-management",children:"Read more about disk management"})})]})]}),(0,r.jsx)(A.A,{required:!0,id:"new-disk-size",label:"New disk size",labelOptional:"GB",disabled:!z})]}),(0,r.jsx)(y.A.Separator,{}),(0,r.jsxs)(y.A.Content,{className:"flex space-x-2 justify-end",children:[(0,r.jsx)(j.$,{type:"default",onClick:()=>S(!1),children:"Cancel"}),(0,r.jsx)(j.$,{htmlType:"submit",type:"primary",disabled:!z||G,loading:G,children:"Update disk size"})]})]})}):(0,r.jsxs)(b.Fc,{className:"border-none",children:[(0,r.jsx)(_.mo,{}),(0,r.jsx)(b.XL,{children:(null==T||null==(t=T.plan)?void 0:t.id)==="free"?"Disk size configuration is not available for projects on the Free Plan":"Disk size configuration is only available when the spend cap has been disabled"}),(0,r.jsxs)(b.TN,{children:[(null==T||null==(a=T.plan)?void 0:a.id)==="free"?(0,r.jsx)("p",{children:"If you are intending to use more than 500MB of disk space, then you will need to upgrade to at least the Pro Plan."}):(0,r.jsx)("p",{children:"If you are intending to use more than 8GB of disk space, then you will need to disable your spend cap."}),(0,r.jsx)(j.$,{asChild:!0,type:"default",className:"mt-3",children:(0,r.jsx)(c(),{href:"/org/".concat(null==D?void 0:D.slug,"/billing?panel=").concat((null==T||null==(i=T.plan)?void 0:i.id)==="free"?"subscriptionPlan":"costControl"),target:"_blank",children:(null==T||null==(d=T.plan)?void 0:d.id)==="free"?"Upgrade subscription":"Disable spend cap"})})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2147,726,4669,9353,7176,3730,9844,6110,9955,6871,8153,5297,5661,4100,8870,2981,4181,2187,4560,7344,3895,1959,9116,9869,4938,6692,5044,7872,5874,49,2174,971,6642,8434,2602,227,6593,636,8792],()=>t(12873)),_N_E=e.O()}]);