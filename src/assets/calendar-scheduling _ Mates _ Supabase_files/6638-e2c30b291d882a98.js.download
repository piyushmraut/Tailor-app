!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="744a65bb-627b-4911-b241-7dd16b9dca40",e._sentryDebugIdIdentifier="sentry-dbid-744a65bb-627b-4911-b241-7dd16b9dca40")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6638],{6263:(e,t,s)=>{s.d(t,{yA:()=>D,uJ:()=>C,TW:()=>R,Mn:()=>O,vY:()=>S,FI:()=>A});var n=s(80263),a=s(53434),r=s.n(a),i=s(42938),o=s(99709),l=s(28097),c=s(24560),d=s(64036),u=s(9093),m=s(51859),x=s(9729),h=s(51527),p=s(6579),f=s(21541),v=s(62659),g=s(24649),y=s(48460),j=s(53239),b=s(74115),w=s(71126);let _=e=>{let{col:t,setSortByValue:s}=e,a=(0,j.useRef)(0),[r,i]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{a.current=Number(new Date)},[r]),(0,n.jsxs)("div",{className:"flex items-center justify-between font-normal text-xs w-full","data-sentry-component":"HeaderCell","data-sentry-source-file":"UsersGridComponents.tsx",children:[(0,n.jsx)("div",{className:"flex items-center gap-x-2",children:(0,n.jsx)("p",{className:"!text-foreground",children:t.name})}),["created_at","email","phone"].includes(t.id)&&(0,n.jsxs)(b.rI,{open:r,onOpenChange:e=>{!1===e&&Number(new Date)-a.current>100&&i(e)},children:[(0,n.jsx)(b.ty,{asChild:!0,children:(0,n.jsx)(w.$,{type:"text",icon:(0,n.jsx)(v.A,{}),className:"p-0 h-5 w-5",onClick:()=>i(!r)})}),(0,n.jsxs)(b.SQ,{className:"w-36",children:[(0,n.jsxs)(b._2,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":desc"))},children:[(0,n.jsx)(g.A,{size:14}),"Sort descending"]}),(0,n.jsxs)(b._2,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":asc"))},children:[(0,n.jsx)(y.A,{size:14}),"Sort ascending"]})]})]})]})},N="https://avatars.githubusercontent.com",k=[N,"https://lh3.googleusercontent.com"],S=e=>{let{currentTarget:t}=e;return t.scrollTop+10>=t.scrollHeight-t.clientHeight},C=e=>e.map(e=>{var t,s;let n=null!=(s=null==(t=e.raw_app_meta_data)?void 0:t.provider)?s:"",a=e.providers.map(e=>e.startsWith("sso")?"SAML":e);return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,providers:e.is_anonymous?"-":a,provider_icons:a.map(e=>"email"===e?"".concat(d.o2,"/img/icons/email-icon2.svg"):"SAML"===e?"".concat(d.o2,"/img/icons/saml-icon.svg"):A[e]?"".concat(d.o2,"/img/icons/").concat(A[e],".svg"):void 0).filter(Boolean),provider_type:e.is_anonymous?"Anonymous":"email"===n?"-":M.includes(n)?"Social":E.includes(n)?"Phone":"-",img:R(e),name:O(e)}}),U={social:[{email:"email-icon2"},{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin_oidc:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack_oidc:"slack-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],phone:[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}]},A=Object.values([...U.social,...U.phone]).reduce((e,t)=>{let[[s,n]]=Object.entries(t);return{...e,[s]:n}},{}),M=U.social.map(e=>{let[t]=Object.keys(e);return t}),E=U.phone.map(e=>{let[t]=Object.keys(e);return t});function F(e){if(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>F(e)).join(" ");try{return JSON.stringify(e)}catch(e){}}}function O(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{custom_claims:n,displayName:a,display_name:r,fullName:i,full_name:o,familyName:l,family_name:c,givenName:d,given_name:u,surname:m,lastName:x,last_name:h,firstName:p,first_name:f}=null!=(t=e.raw_user_meta_data)?t:{},{displayName:v,display_name:g,fullName:y,full_name:j,familyName:b,family_name:w,givenName:_,given_name:N,surname:k,lastName:S,last_name:C,firstName:U,first_name:A}=null!=n?n:{},M=F(l||c||m||x||h||b||w||k||S||C),E=F(d||u||p||f||_||N||U||A);return F(a||r||v||g||i||o||y||j||E&&M&&"".concat(E," ").concat(M)||M||E)||s}function R(e){var t;let{avatarUrl:s,avatarURL:n,avatar_url:a,profileUrl:r,profileURL:i,profile_url:o,profileImage:l,profile_image:c,profileImageUrl:d,profileImageURL:u,profile_image_url:m}=null!=(t=e.raw_user_meta_data)?t:{},x=s||n||a||l||c||r||i||o||d||u||m||"";if("string"!=typeof x)return;let h=k.some(e=>x.startsWith(e));try{let e=new URL(x);return e.searchParams.set("s","24"),h?x.startsWith(N)?e.href:x:void 0}catch(e){return h?x:void 0}}let D=e=>{var t;let{config:s,users:a,visibleColumns:d=[],setSortByValue:v,onSelectDeleteUser:g}=e,y=null!=(t=s.map(e=>e.id))?t:f.AF.map(e=>e.id),j=f.AF.map(e=>{var t,d,f;let y=s.find(t=>t.id===e.id);return{key:e.id,name:e.name,resizable:null==(t=e.resizable)||t,sortable:!1,draggable:!0,width:null!=(d=null==y?void 0:y.width)?d:e.width,minWidth:null!=(f=e.minWidth)?f:120,headerCellClass:"z-50 outline-none !shadow-none",renderHeaderCell:()=>{if("img"!==e.id)return(0,n.jsx)(_,{col:e,setSortByValue:v})},renderCell:t=>{let{row:s}=t,[d,f]=(0,c.Uk)(),v=null==s?void 0:s[e.id],y=null==a?void 0:a.find(e=>e.id===s.id),j=null!==v&&["created_at","last_sign_in_at"].includes(e.id)?r()(v).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):Array.isArray(v)?"providers"===e.id?v.map(e=>{let t=p.S5.find(t=>"key"in t&&t.key===e||t.title.toLowerCase()===e);return null==t?void 0:t.title}).join(", "):v.join(", "):v,b=!!(null==y?void 0:y.confirmed_at);return"img"===e.id?(0,n.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,n.jsx)(u.S,{checked:d,onClick:e=>{e.stopPropagation(),f({row:s,type:"ROW",checked:!d,isShiftClick:e.shiftKey})}}),(0,n.jsx)("div",{className:(0,m.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",s.img?"border":"bg-selection"),style:{backgroundImage:s.img?"url('".concat(s.img,"')"):"none"},children:!s.img&&(0,n.jsx)(i.A,{size:12})})]}):(0,n.jsxs)(x.tz,{children:[(0,n.jsx)(x.Rc,{asChild:!0,children:(0,n.jsxs)("div",{className:(0,m.cn)("w-full flex items-center text-xs",e.id.includes("provider")?"capitalize":""),children:["providers"===e.id&&s.provider_icons.map((e,t)=>{let a=s.providers[t];return(0,n.jsx)("div",{className:"min-w-6 min-h-6 rounded-full border flex items-center justify-center bg-surface-75",style:{marginLeft:0===t?0:"-8px",zIndex:s.provider_icons.length-t},children:(0,n.jsx)("img",{width:16,src:e,alt:"".concat(a," auth icon"),className:(0,m.cn)("github"===a&&"dark:invert")},"".concat(null==y?void 0:y.id,"-").concat(a))})}),"last_sign_in_at"!==e.id||b?(0,n.jsx)("p",{className:(0,m.cn)("providers"===e.id&&"ml-1"),children:null===j?"-":j}):(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}),(0,n.jsxs)(x.Ip,{onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)(x.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{let t="providers"===e.id?s.providers.join(", "):j;(0,h.l)(t)},children:[(0,n.jsx)(o.A,{size:12}),(0,n.jsxs)("span",{children:["Copy ","id"===e.id?e.name:e.name.toLowerCase()]})]}),(0,n.jsx)(x.K5,{}),(0,n.jsxs)(x.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{y&&g(y)},children:[(0,n.jsx)(l.A,{size:12}),(0,n.jsx)("span",{children:"Delete user"})]})]})]})}}}),b=j.find(e=>"img"===e.key);return y.length>0&&(j=j.filter(e=>y.includes(e.key)).sort((e,t)=>y.indexOf(e.key)-y.indexOf(t.key))),0===d.length?j:[b].concat(j.filter(e=>d.includes(e.key)))}},15862:(e,t,s)=>{s.d(t,{i:()=>c});var n=s(80263),a=s(19898),r=s(73969),i=s(76473),o=s(49443),l=s(64540);let c=e=>{var t,s;let{visible:c,selectedUser:d,onClose:u,onDeleteSuccess:m}=e,{ref:x}=(0,a.g)(),{mutate:h,isLoading:p}=(0,i.X)({onSuccess:()=>{r.oR.success("Successfully deleted ".concat(null==d?void 0:d.email)),null==m||m()}}),f=async()=>(await (0,o.wR)(200),x)?(null==d?void 0:d.id)===void 0?r.oR.error("Failed to delete user: User ID not found"):void h({projectRef:x,userId:d.id}):console.error("Project ref is required");return(0,n.jsx)(l.A,{visible:c,variant:"destructive",title:"Confirm to delete user",loading:p,confirmLabel:"Delete",onCancel:()=>u(),onConfirm:()=>f(),alert:{title:"Deleting a user is irreversible",description:"This will remove the selected the user from the project and all associated data."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"DeleteUserModal","data-sentry-source-file":"DeleteUserModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the user"," ",null!=(s=null!=(t=null==d?void 0:d.email)?t:null==d?void 0:d.phone)?s:"this user","?"]})})}},16580:(e,t,s)=>{s.d(t,{$:()=>r});var n=s(80263),a=s(51859);let r=e=>{let{loading:t}=e;return(0,n.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto","data-sentry-component":"LoadingLine","data-sentry-source-file":"LoadingLine.tsx",children:(0,n.jsx)("span",{className:(0,a.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",t&&"animate-line-loading-slower opacity-100",t?"opacity-100":"opacity-0")})})}},21541:(e,t,s)=>{s.d(t,{AF:()=>l,GS:()=>i,UC:()=>o,jU:()=>r});var n=s(64036),a=s(6579);let r="px-5 py-5",i=20,o=a.S5.map(e=>({name:e.title,value:"key"in e?e.key:e.title.toLowerCase(),icon:"".concat(n.o2,"/img/icons/").concat(e.misc.iconKey,".svg"),iconClass:"GitHub"===e.title?"dark:invert":""})).concat(a.ns.properties.SMS_PROVIDER.enum.map(e=>({name:e.label,value:e.value,icon:"".concat(n.o2,"/img/icons/").concat(e.icon),iconClass:""}))),l=[{id:"img",name:"",minWidth:95,width:95,resizable:!1},{id:"id",name:"UID",width:280},{id:"name",name:"Display name",minWidth:0,width:150},{id:"email",name:"Email",width:300},{id:"phone",name:"Phone"},{id:"providers",name:"Providers",minWidth:150},{id:"provider_type",name:"Provider type",minWidth:150},{id:"created_at",name:"Created at",width:260},{id:"last_sign_in_at",name:"Last sign in at",width:260}]},76473:(e,t,s)=>{s.d(t,{X:()=>c});var n=s(32144),a=s(80251),r=s(73969),i=s(40807),o=s(69830);async function l(e){let{projectRef:t,userId:s}=e,{data:n,error:a}=await (0,i.yH)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}}});return a&&(0,i.H4)(a),n}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.jE)();return(0,a.n)(e=>l(e),{async onSuccess(t,s,n){let{projectRef:a,skipInvalidation:r=!1}=s;r||await Promise.all([i.invalidateQueries(o.Z.usersInfinite(a)),i.invalidateQueries(o.Z.usersCount(a))]),await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?r.oR.error("Failed to delete user: ".concat(e.message)):t(e,s,n)},...s})}},85060:(e,t,s)=>{s.d(t,{dS:()=>el,$U:()=>eo,nz:()=>ei});var n=s(80263),a=s(60045),r=s(53434),i=s.n(r),o=s(44679),l=s(92662),c=s(76084),d=s(84338),u=s(28097),m=s(62763),x=s(14484),h=s(59153),p=s.n(h),f=s(53239),v=s(73969),g=s(19898),y=s(41370),j=s(14430),b=s(25400),w=s(80251),_=s(40807);async function N(e){let{projectRef:t,userId:s}=e,{data:n,error:a}=await (0,_.yH)("/platform/auth/{ref}/users/{id}/factors",{params:{path:{ref:t,id:s}}});return a&&(0,_.H4)(a),n}let k=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>N(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to delete the user's MFA factors: ".concat(e.message)):t(e,s,n)},...s})};async function S(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/recover",{params:{path:{ref:t}},body:{email:s.email}});return a&&(0,_.H4)(a),n}let C=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>S(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to reset user password: ".concat(e.message)):t(e,s,n)},...s})};async function U(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/magiclink",{params:{path:{ref:t}},body:{email:s.email}});return a&&(0,_.H4)(a),n}let A=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>U(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};async function M(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/otp",{params:{path:{ref:t}},body:{phone:s.phone}});return a&&(0,_.H4)(a),n}let E=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>M(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};var F=s(32144),O=s(69830);async function R(e){let{projectRef:t,userId:s,banDuration:n}=e,{data:a,error:r}=await (0,_.F6)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}},body:{ban_duration:"number"==typeof n?"".concat(n,"h"):n}});return r&&(0,_.H4)(r),a}let D=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,F.jE)();return(0,w.n)(e=>R(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(O.Z.usersInfinite(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?v.oR.error("Failed to update user: ".concat(e.message)):t(e,s,n)},...s})};var L=s(77227),P=s(64036),T=s(49443),I=s(51859),H=s(22979),z=s(71126),B=s(10406),Y=s(64540),W=s(6579),G=s(32981),Z=s(87494),$=s(39353),X=s(67920),Q=s(57980),V=s(24794),q=s(20894),J=s(84377);let K=e=>{let{visible:t,user:s,onClose:a}=e,{ref:r}=(0,g.g)(),{mutate:o,isLoading:l}=D({onSuccess:(e,t)=>{let s=i()().add(Number(t.banDuration),"hours").format("DD MMM YYYY HH:mm (ZZ)");v.oR.success("User banned successfully until ".concat(s)),a()}}),c=$.Ik({value:$.Yj().min(1,{message:"Please provide a duration"}),unit:$.k5(["hours","days"])}),d={value:"24",unit:"hours"},u=(0,Z.mN)({mode:"onBlur",reValidateMode:"onChange",resolver:(0,G.u)(c),defaultValues:d}),{value:m,unit:x}=u.watch(),h=i()().add(Number(m),x).format("DD MMM YYYY HH:mm (ZZ)");return(0,f.useEffect)(()=>{t&&u.reset(d)},[t]),(0,n.jsx)(X.A,{hideFooter:!0,visible:t,size:"small",header:"Confirm to ban user",onCancel:()=>a(),"data-sentry-element":"Modal","data-sentry-component":"BanUserModal","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsx)(Q.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsxs)("form",{onSubmit:u.handleSubmit(e=>{if(void 0===r)return console.error("Project ref is required");if(void 0===s.id)return v.oR.error("Failed to ban user: User ID not found");let t="hours"===e.unit?Number(e.value):24*Number(e.value);o({projectRef:r,userId:s.id,banDuration:t})}),children:[(0,n.jsxs)(X.A.Content,{className:"flex flex-col gap-y-3","data-sentry-element":"unknown","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm",children:"This will revoke the user's access to your project and prevent them from logging in for a specified duration."}),(0,n.jsxs)("div",{className:"flex items-start gap-x-2 [&>div:first-child]:flex-grow",children:[(0,n.jsx)(Q.zB,{control:u.control,name:"value",render:e=>{let{field:t}=e;return(0,n.jsx)(J.M,{className:"[&>div>div]:mt-0",label:"Set a ban duration",children:(0,n.jsx)(Q.MJ,{children:(0,n.jsx)(V.p,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsx)(Q.zB,{control:u.control,name:"unit",render:e=>{let{field:t}=e;return(0,n.jsx)(J.M,{className:"[&>div>div]:mt-0 mt-[33px]",children:(0,n.jsx)(Q.MJ,{children:(0,n.jsxs)(q.l6,{...t,value:t.value,onValueChange:e=>u.setValue("unit",e),children:[(0,n.jsx)(q.bq,{className:"capitalize w-24",children:t.value}),(0,n.jsxs)(q.gC,{children:[(0,n.jsx)(q.eb,{value:"hours",children:"Hours"}),(0,n.jsx)(q.eb,{value:"days",children:"Days"})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:"This user will not be able to log in until:"}),(0,n.jsx)("p",{className:(0,I.cn)("text-sm",!m&&"text-foreground-light"),children:m?h:"Invalid duration set"})]})]}),(0,n.jsx)(H.w,{"data-sentry-element":"Separator","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsxs)(X.A.Content,{className:"flex justify-end gap-2","data-sentry-element":"unknown","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)(z.$,{type:"default",disabled:l,onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Cancel"}),(0,n.jsx)(z.$,{type:"warning",htmlType:"submit",loading:l,"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Confirm ban"})]})]})})})};var ee=s(15862),et=s(97893),es=s(21541),en=s(6263);let ea="DD MMM, YYYY HH:mm",er=(0,I.cn)("bg-surface-100 border-default text-foreground flex items-center justify-between","gap-x-4 border px-5 py-4 text-sm first:rounded-tr first:rounded-tl last:rounded-br last:rounded-bl"),ei=e=>{var t,s,r,m,x;let{user:h,onDeleteSuccess:y}=e,{ref:j}=(0,g.g)(),w=null!==h.email,_=null!==h.phone,N=null!==h.banned_until,S=(null!=(s=null==(t=h.raw_app_meta_data)?void 0:t.providers)?s:[]).map(e=>({name:e.startsWith("sso")?"SAML":e,icon:"email"===e?"".concat(P.o2,"/img/icons/email-icon2.svg"):en.FI[e]?"".concat(P.o2,"/img/icons/").concat(en.FI[e],".svg"):void 0})),U=(0,L.SE)(a.aG.AUTH_EXECUTE,"*"),M=(0,L.SE)(a.aG.AUTH_EXECUTE,"send_magic_link"),F=(0,L.SE)(a.aG.AUTH_EXECUTE,"send_recovery"),O=(0,L.SE)(a.aG.AUTH_EXECUTE,"send_otp"),R=(0,L.SE)(a.aG.TENANT_SQL_DELETE,"auth.users"),G=(0,L.SE)(a.aG.TENANT_SQL_DELETE,"auth.mfa_factors"),[Z,$]=(0,f.useState)(),[X,Q]=(0,f.useState)(!1),[V,q]=(0,f.useState)(!1),[J,ei]=(0,f.useState)(!1),[ec,ed]=(0,f.useState)(!1),{data:eu}=(0,b.op)({projectRef:j}),em=null!=(r=null==eu?void 0:eu.MAILER_OTP_EXP)?r:0,ex=Math.floor(em/60),eh=Math.floor(em%60),ep="".concat(em>60?"".concat(ex," minute").concat(ex>1?"s":""," ").concat(eh>0?"and":""," "):"").concat(eh>0?"".concat(eh," second").concat(eh>1?"s":""):""),{mutate:ef,isLoading:ev}=C({onSuccess:(e,t)=>{$("send_recovery"),v.oR.success("Sent password recovery to ".concat(t.user.email))},onError:e=>{v.oR.error("Failed to send password recovery: ".concat(e.message))}}),{mutate:eg,isLoading:ey}=A({onSuccess:(e,t)=>{$("send_magic_link"),v.oR.success("Sent magic link to ".concat(t.user.email))},onError:e=>{v.oR.error("Failed to send magic link: ".concat(e.message))}}),{mutate:ej,isLoading:eb}=E({onSuccess:(e,t)=>{$("send_otp"),v.oR.success("Sent OTP to ".concat(t.user.phone))},onError:e=>{v.oR.error("Failed to send OTP: ".concat(e.message))}}),{mutate:ew}=k({onSuccess:()=>{v.oR.success("Successfully deleted the user's factors"),ed(!1)}}),{mutate:e_,isLoading:eN}=D({onSuccess:()=>{v.oR.success("Successfully unbanned user"),q(!1)}}),ek=async()=>{if(await (0,T.wR)(200),!j)return console.error("Project ref is required");ew({projectRef:j,userId:h.id})},eS=()=>void 0===j?console.error("Project ref is required"):void 0===h.id?v.oR.error("Failed to ban user: User ID not found"):void e_({projectRef:j,userId:h.id,banDuration:"none"});return(0,f.useEffect)(()=>{if(void 0!==Z){let e=setTimeout(()=>$(void 0),5e3);return()=>clearTimeout(e)}},[Z]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(et.x,{user:h,"data-sentry-element":"UserHeader","data-sentry-source-file":"UserOverview.tsx"}),N?(0,n.jsx)(B.Z,{type:"warning",label:"User banned until ".concat(i()(h.banned_until).format(ea)),className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0"}):(0,n.jsx)(H.w,{}),(0,n.jsxs)("div",{className:(0,I.cn)("flex flex-col gap-y-1",es.jU),children:[(0,n.jsx)(eo,{property:"User UID",value:h.id,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Created at",value:h.created_at?i()(h.created_at).format(ea):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Updated at",value:h.updated_at?i()(h.updated_at).format(ea):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Invited at",value:h.invited_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Confirmation sent at",value:h.confirmation_sent_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Confirmed at",value:h.confirmed_at?i()(h.confirmed_at).format(ea):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Last signed in",value:h.last_sign_in_at?i()(h.last_sign_in_at).format(ea):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"SSO",value:h.is_sso_user,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"})]}),(0,n.jsxs)("div",{className:(0,I.cn)("flex flex-col !pt-0",es.jU),children:[(0,n.jsx)("p",{children:"Provider Information"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user has the following providers"})]}),(0,n.jsx)("div",{className:(0,I.cn)("flex flex-col -space-y-1 !pt-0",es.jU),children:S.map(e=>{var t,s,a;let r=W.S5.find(t=>"key"in t&&t.key===e.name||t.title.toLowerCase()===e.name),i=Object.keys(null!=(t=null==r?void 0:r.properties)?t:{}).find(e=>e.toLowerCase().endsWith("_enabled")),l="email"===e.name?e.name.toLowerCase():null!=(s=null==r?void 0:r.title)?s:e.name,c=null!=(a=null==eu?void 0:eu[i])&&a;return(0,n.jsxs)("div",{className:(0,I.cn)(er,"items-start justify-start"),children:[e.icon&&(0,n.jsx)("img",{width:16,src:e.icon,alt:"".concat(e.name," auth icon"),className:(0,I.cn)("mt-1.5","github"===e.name?"dark:invert":"")}),(0,n.jsxs)("div",{className:"flex-grow mt-0.5",children:[(0,n.jsx)("p",{className:"capitalize",children:l}),(0,n.jsxs)("p",{className:"text-xs text-foreground-light",children:["Signed in with a ",l," account via"," ","SAML"===l?"SSO":"OAuth"]}),(0,n.jsx)(z.$,{asChild:!0,type:"default",className:"mt-2",children:(0,n.jsxs)(p(),{href:"/project/".concat(j,"/auth/providers?provider=").concat("SAML"===e.name?"SAML 2.0":e.name),children:["Configure ",l," provider"]})})]}),c?(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,n.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,n.jsx)(o.A,{strokeWidth:2,size:12})}),(0,n.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,n.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"})]},e.name)})}),(0,n.jsx)(H.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,I.cn)("flex flex-col -space-y-1",es.jU),children:[w&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(el,{title:"Reset password",description:"Send a password recovery email to the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send password recovery",isLoading:ev,disabled:!F,onClick:()=>{j&&ef({projectRef:j,user:h})}},success:"send_recovery"===Z?{title:"Password recovery sent",description:"The link in the email is valid for ".concat(ep)}:void 0}),(0,n.jsx)(el,{title:"Send magic link",description:"Passwordless login via email for the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send magic link",isLoading:ey,disabled:!M,onClick:()=>{j&&eg({projectRef:j,user:h})}},success:"send_magic_link"===Z?{title:"Magic link sent",description:"The link in the email is valid for ".concat(ep)}:void 0})]}),_&&(0,n.jsx)(el,{title:"Send OTP",description:"Passwordless login via phone for the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send OTP",isLoading:eb,disabled:!O,onClick:()=>{j&&ej({projectRef:j,user:h})}},success:"send_otp"===Z?{title:"OTP sent",description:"The link in the OTP SMS is valid for ".concat(ep)}:void 0})]}),(0,n.jsx)(H.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,I.cn)("flex flex-col",es.jU),children:[(0,n.jsx)("p",{children:"Danger zone"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Be wary of the following features as they cannot be undone."})]}),(0,n.jsxs)("div",{className:(0,I.cn)("flex flex-col -space-y-1 !pt-0",es.jU),children:[(0,n.jsx)(el,{title:"Remove MFA factors",description:"Removes all MFA factors associated with the user",button:{icon:(0,n.jsx)(c.A,{}),text:"Remove MFA factors",disabled:!G,onClick:()=>ed(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{title:N?"User is banned until ".concat(i()(h.banned_until).format(ea)):"Ban user",description:N?"User has no access to the project until after this date":"Revoke access to the project for a set duration",button:{icon:(0,n.jsx)(d.A,{}),text:N?"Unban user":"Ban user",disabled:!U,onClick:()=>{N?q(!0):Q(!0)}},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{title:"Delete user",description:"User will no longer have access to the project",button:{icon:(0,n.jsx)(u.A,{}),type:"danger",text:"Delete user",disabled:!R,onClick:()=>ei(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"})]})]}),(0,n.jsx)(ee.i,{visible:J,selectedUser:h,onClose:()=>ei(!1),onDeleteSuccess:()=>{ei(!1),y()},"data-sentry-element":"DeleteUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(Y.A,{visible:ec,variant:"warning",title:"Confirm to remove MFA factors",confirmLabel:"Remove factors",confirmLabelLoading:"Removing",onCancel:()=>ed(!1),onConfirm:()=>ek(),alert:{base:{variant:"warning"},title:"Removing MFA factors will drop the user's authentication assurance level (AAL) to AAL1",description:"Note that this does not sign the user out"},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove the MFA factors for the user"," ",(0,n.jsx)("span",{className:"text-foreground",children:null!=(x=null!=(m=h.email)?m:h.phone)?x:"this user"}),"?"]})}),(0,n.jsx)(K,{visible:X,user:h,onClose:()=>Q(!1),"data-sentry-element":"BanUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(Y.A,{variant:"warning",visible:V,title:"Confirm to unban user",loading:eN,confirmLabel:"Unban user",confirmLabelLoading:"Unbanning",onCancel:()=>q(!1),onConfirm:()=>eS(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user will have access to your project again once unbanned. Are you sure you want to unban this user?"})})]})},eo=e=>{let{property:t,value:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 group justify-between",children:[(0,n.jsx)("p",{className:" text-foreground-lighter text-xs",children:t}),"boolean"==typeof s?(0,n.jsx)("div",{className:"h-[26px] flex items-center justify-center min-w-[70px]",children:s?(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(o.A,{size:10,className:"text-contrast",strokeWidth:4})}):(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(m.A,{size:10,className:"text-contrast",strokeWidth:4})})}):(0,n.jsxs)("div",{className:"flex items-center gap-x-2 h-[26px] font-mono min-w-[40px]",children:[(0,n.jsx)("p",{className:"text-xs",children:s||"-"}),!!s&&(0,n.jsx)(j.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(x.A,{}),className:"transition opacity-0 group-hover:opacity-100 px-1",text:s})]})]}),(0,n.jsx)(H.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"})]})},el=e=>{var t,s,a;let{title:r,description:i,button:l,success:c,className:d}=e,u=null!=(t=null==l?void 0:l.disabled)&&t;return(0,n.jsxs)("div",{className:(0,I.cn)(er,d),"data-sentry-component":"RowAction","data-sentry-source-file":"UserOverview.tsx",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:c?c.title:r}),(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:c?c.description:i})]}),(0,n.jsx)(y.G,{type:null!=(s=null==l?void 0:l.type)?s:"default",icon:c?(0,n.jsx)(o.A,{className:"text-brand"}):l.icon,loading:null!=(a=l.isLoading)&&a,onClick:l.onClick,disabled:u,tooltip:{content:{side:"bottom",text:u?"You need additional permissions to ".concat(l.text.toLowerCase()):void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"UserOverview.tsx",children:l.text})]})}},91494:(e,t,s)=>{s.d(t,{I:()=>u});var n=s(80263),a=s(53239),r=s(95793),i=s(71126),o=s(51859),l=s(67585),c=s(9093),d=s(97380);let u=e=>{let{title:t,options:s=[],activeOptions:u=[],valueKey:m,labelKey:x,iconKey:h="icon",name:p="default",variant:f="rectangular",buttonType:v,disabled:g,labelClass:y,className:j,maxHeightClass:b="h-[205px]",clearButtonText:w="Clear",onSaveFilters:_}=e,[N,k]=(0,a.useState)(!1),[S,C]=(0,a.useState)([]),U=u.map(e=>{let t=s.find(t=>t[m]===e);return t&&t[x]?t[x]:""});return(0,a.useEffect)(()=>{!N&&u.length>0&&C(u)},[N,u]),(0,n.jsxs)(r.AM,{open:N,onOpenChange:k,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)(r.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)(i.$,{asChild:!0,disabled:g,type:null!=v?v:u.length>0?"default":"dashed",onClick:()=>k(!1),className:"rounded"===f?"rounded-full":"","data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:p}),u.length>0&&(0,n.jsx)("span",{className:"mr-1",children:":"}),u.length>=3?(0,n.jsxs)("span",{children:[U[0]," and ",u.length-1," others"]}):u.length>0?(0,n.jsx)("span",{children:U.join(", ")}):null]})})}),(0,n.jsxs)(r.hl,{className:(0,o.cn)("p-0 w-44",j),align:"start",portal:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)("div",{className:"border-b border-overlay bg-surface-200 rounded-t pb-1 px-3",children:(0,n.jsx)("span",{className:"text-xs text-foreground-light",children:null!=t?t:"Select ".concat(p.toLowerCase())})}),(0,n.jsx)(l.FK,{className:s.length>7?b:"","data-sentry-element":"ScrollArea","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)("div",{className:"p-3 flex flex-col gap-y-2",children:s.map(e=>{let t=e[m],s=h?e[h]:void 0;return(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(c.S,{id:t,checked:S.includes(t),onCheckedChange:()=>{S.includes(t)?C(S.filter(e=>e!==t)):C(S.concat(t))}}),(0,n.jsxs)(d.J,{htmlFor:e[m],className:(0,o.cn)("flex items-center gap-x-2 text-xs",y),children:[s&&(0,n.jsx)("img",{src:s,alt:e[x],className:(0,o.cn)("w-4 h-4",e.iconClass)}),(0,n.jsx)("span",{children:e[x]})]})]},t)})})}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,n.jsx)(i.$,{size:"tiny",type:"default",onClick:()=>{_([]),C([]),k(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:w}),(0,n.jsx)(i.$,{type:"primary",onClick:()=>{let e=s.map(e=>e[m]);_(S.sort((t,s)=>e.indexOf(t)-e.indexOf(s))),k(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Save"})]})]})]})}},97893:(e,t,s)=>{s.d(t,{x:()=>c});var n=s(80263),a=s(14484),r=s(14430),i=s(51859),o=s(21541),l=s(6263);let c=e=>{var t,s,c;let{user:d}=e,u=(0,l.Mn)(d),m="-"!==u,x=null!==d.phone,h=d.is_anonymous;return(0,n.jsx)("div",{className:(0,i.cn)(o.jU),"data-sentry-component":"UserHeader","data-sentry-source-file":"UserHeader.tsx",children:x?(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{children:d.phone}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(t=null==d?void 0:d.phone)?t:""})]}):h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Anonymous user"}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:d.id}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(s=null==d?void 0:d.id)?s:""})]})]}):(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)("p",{children:u}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:(0,i.cn)(m?"text-foreground-light text-sm":"text-foreground"),children:d.email}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(c=null==d?void 0:d.email)?c:""})]})]})})}}}]);