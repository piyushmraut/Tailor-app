!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b6706cea-223f-4ede-b24b-30a89a2bef8d",e._sentryDebugIdIdentifier="sentry-dbid-b6706cea-223f-4ede-b24b-30a89a2bef8d")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4253,8426],{4487:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var s=n(80263),a=n(60045),r=n(27452),i=n(44679),l=n(66345),o=n(53239),c=n(97872),d=n(788),u=n(77227),m=n(71126),x=n(25171),h=n(70324),g=n(95793),f=n(36141),p=n(67585);let j=e=>{let{className:t,disabled:n=!1,size:j="tiny",showError:y=!0,selectedSchemaName:v,supportSelectAll:b=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:_,portal:S=!0}=e,[A,C]=(0,o.useState)(!1),E=(0,u.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:q}=(0,c.Om)(),{data:T,isLoading:k,isSuccess:F,isError:R,error:I,refetch:M}=(0,d.w$)({projectRef:null==q?void 0:q.ref,connectionString:null==q?void 0:q.connectionString}),L=(T||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[k&&(0,s.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:j,disabled:!0,children:(0,s.jsx)(x.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),y&&R&&(0,s.jsxs)(h.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(h.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(h.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,s.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>M(),children:"Reload schemas"})]}),F&&(0,s.jsxs)(g.AM,{open:A,onOpenChange:C,modal:!1,children:[(0,s.jsx)(g.Wv,{asChild:!0,children:(0,s.jsx)(m.$,{size:j,disabled:n,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,s.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,s.jsx)(g.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:S,sameWidthAsTrigger:!0,children:(0,s.jsxs)(f.uB,{children:[(0,s.jsx)(f.G7,{placeholder:"Find schema..."}),(0,s.jsxs)(f.oI,{children:[(0,s.jsx)(f.xL,{children:"No schemas found"}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(p.FK,{className:(L||[]).length>7?"h-[210px]":"",children:[b&&(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),C(!1)},onClick:()=>{w("*"),C(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===v&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==L?void 0:L.map(e=>(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),C(!1)},onClick:()=>{w(e.name),C(!1)},children:[(0,s.jsx)("span",{children:e.name}),v===e.name&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==_&&E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.fx,{}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{_(),C(!1)},onClick:()=>{_(),C(!1)},children:[(0,s.jsx)(l.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},8723:(e,t,n)=>{"use strict";n.d(t,{Lh:()=>u,T_:()=>g});var s=n(32144),a=n(80251),r=n(73969),i=n(26616),l=n.n(i),o=n(96557),c=n(45942),d=n(95059);let u="pgmq_public",m=l()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n\n\n/*\n  Grant access to sequences to API roles by default. Existing table permissions\n  continue to enforce insert restrictions. This is necessary to accommodate the\n  on-backup hook that rebuild queue table primary keys to avoid a pg_dump segfault.\n  This can be removed once logical backups are completely retired.\n*/\ngrant usage, select, update\non all sequences in schema pgmq\nto anon, authenticated, service_role;\n\nalter default privileges in schema pgmq\ngrant usage, select, update\non sequences\nto anon, authenticated, service_role;\n")),x=l()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function h(e){let{projectRef:t,connectionString:n,enable:s}=e,{result:a}=await (0,o.E)({projectRef:t,connectionString:n,sql:s?m:x,queryKey:["toggle-queues-exposure"]});return a}let g=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,s.jE)();return(0,a.n)(e=>h(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await i.invalidateQueries(c.m.exposePostgrestStatus(a)),i.invalidateQueries(d.c.schemas(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?r.oR.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):t(e,n,s)},...n})}},10585:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var s=n(80263),a=n(55866);let r=e=>{let{resourceText:t,isFullPage:n=!1}=e,r=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(r,{})})}):(0,s.jsx)(r,{})}},12091:(e,t,n)=>{"use strict";n.d(t,{fl:()=>l,oR:()=>o});var s=n(56947),a=n(40807),r=n(49389);async function i(e,t){let{projectRef:n,connectionString:s}=e;if(!n)throw Error("projectRef is required");let r=new Headers;s&&r.set("x-connection-encrypted",s);let{data:i,error:l}=await (0,a.Jt)("/platform/pg-meta/{ref}/triggers",{params:{header:{"x-connection-encrypted":s},path:{ref:n},query:void 0},headers:r,signal:t});return l&&(0,a.H4)(l),i}let l=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.U.list(t),e=>{let{signal:s}=e;return i({projectRef:t,connectionString:n},s)},{select:e=>e.filter(e=>"supabase_functions"===e.function_schema&&("net"!==e.schema||0===e.function_args.length)),enabled:a&&void 0!==t,...l})},o=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(r.U.list(t),e=>{let{signal:s}=e;return i({projectRef:t,connectionString:n},s)},{enabled:a&&void 0!==t,...l})}},12484:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var s=n(80263),a=n(59153),r=n.n(a),i=n(38220),l=n(65863),o=n(71126);let c=e=>{let{name:t="",isActive:n,isExternal:a,icon:c,rightIcon:d,url:u="",target:m="_self",onClick:x,textClassName:h="",hoverText:g="",label:f}=e,p=(0,s.jsx)(i.Ay.Item,{icon:c,rounded:!0,active:n,onClick:x,children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,s.jsxs)("div",{title:g||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+h,children:[(0,s.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,s.jsx)(l.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,s.jsx)("div",{children:d})]})});return u?a?(0,s.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,s.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,s.jsx)(r(),{href:u,className:"block",target:m,children:p}):p}},21519:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/triggers",function(){return n(45388)}])},25321:(e,t,n)=>{"use strict";n.d(t,{k:()=>l});var s=n(12056),a=n(53239),r=n(19898);let i=e=>(0,s.ZA)("schema",s.tU.withDefault(e)),l=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[n,s]=i((0,a.useMemo)(()=>t,[e]));return(0,a.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),n)},[n,e]),{selectedSchema:n,setSelectedSchema:s}}},25549:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var s=n(80263),a=n(47504),r=n(90915),i=n(39071),l=n(89771),o=n(45174),c=n(68875),d=n(80207),u=n(72602),m=n(26551);let x=()=>{let e=(0,c.KT)(),t=(0,a.useRouter)().pathname.split("/")[4],{data:n}=(0,l.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:d}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),u=void 0!==(null!=n?n:[]).find(e=>"pg_net"===e.name),x=(null==d?void 0:d.selected_addons.find(e=>"pitr"===e.type))!==void 0,h=(0,r.p4)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.l,{page:t,menu:(0,m.k)(e,{pgNetExtensionExists:u,pitrEnabled:x,columnLevelPrivileges:h}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},h=(0,d.r)(e=>{let{children:t}=e;return(0,s.jsx)(u.A,{product:"Database",productMenu:(0,s.jsx)(x,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},38220:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>m});var s=n(80263),a=n(53239),r=n(16865),i=n(51859);function l(e){let{children:t,className:n,tag:a="div",style:r}=e;return(0,s.jsx)("".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}l.Title=function(e){let{className:t,level:n=1,children:a,style:r}=e;return(0,s.jsx)("h".concat(n),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:a})},l.Text=function(e){let{className:t,children:n,style:a,type:r,disabled:i,mark:l,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:x}=e;return o?(0,s.jsx)("code",{style:a,children:n}):l?(0,s.jsx)("mark",{style:a,children:n}):c?(0,s.jsx)("kbd",{style:a,children:n}):m?(0,s.jsx)("strong",{style:a,children:n}):(0,s.jsx)("span",{style:a,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:n})},l.Link=function(e){let{children:t,target:n="_blank",href:a,className:r,onClick:i,style:l}=e;return(0,s.jsx)("a",{onClick:i,href:a,target:n,rel:"noopener noreferrer",style:l,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let o=(0,a.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,s.jsx)(o.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:n,ulClassName:a,style:r,type:i="text"}=e;return(0,s.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:n,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(c,{type:i,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("ul",{className:a,children:t})})})}u.Item=function(e){let{children:t,icon:n,active:a,rounded:l,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:m}=e,x=(0,r.A)("menu"),{type:h}=d(),g=[x.item.base];g.push(x.item.variants[h].base),a?g.push(x.item.variants[h].active):g.push(x.item.variants[h].normal);let f=[x.item.content.base];a?f.push(x.item.content.active):f.push(x.item.content.normal);let p=[x.item.icon.base];return a?p.push(x.item.icon.active):p.push(x.item.icon.normal),(0,s.jsxs)("li",{role:"menuitem",className:(0,i.cn)("outline-none",g),style:m,onClick:o,"aria-current":a?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[n&&(0,s.jsx)("div",{className:"".concat(p.join(" ")," min-w-fit"),children:n}),(0,s.jsx)("span",{className:f.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:n,title:a}=e,i=(0,r.A)("menu"),{type:l}=d();return(0,s.jsxs)("div",{className:[i.group.base,i.group.variants[l]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[n&&(0,s.jsx)("span",{className:i.group.icon,children:n}),(0,s.jsx)("span",{className:i.group.content,children:a}),t]})},u.Misc=function(e){let{children:t}=e;return(0,s.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(l.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("span",{children:t})})})};let m=u},38543:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var s=n(45874),a=n(56947),r=n(95059),i=n(96557);let l=s.A.functions.list();async function o(e,t,n){let{projectRef:s,connectionString:a}=e,r=new Headers(n),{result:o}=await (0,i.E)({projectRef:s,connectionString:a,sql:l.sql,queryKey:["database-functions"]},t,r);return o}let c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.c.databaseFunctions(t),e=>{let{signal:s}=e;return o({projectRef:t,connectionString:n},s)},{enabled:s&&void 0!==t,...i})}},39071:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(80263),a=n(38220),r=n(65863),i=n(12484);let l=e=>{let{page:t,menu:n}=e;return(0,s.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,s.jsx)(a.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:n.map((e,l)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"my-6 space-y-8",children:(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(a.Ay.Group,{title:e.title?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,s.jsx)("span",{children:e.title}),e.isPreview&&(0,s.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,s.jsx)("div",{children:e.items.map(e=>{let n=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,s.jsx)(i.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:n,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),l!==n.length-1&&(0,s.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},40402:(e,t,n)=>{"use strict";n.d(t,{BS:()=>l,Dm:()=>d,HJ:()=>y,Rf:()=>p,Uw:()=>c,Vw:()=>N,Xr:()=>b,aw:()=>g,bV:()=>i,cJ:()=>x,dX:()=>u,eh:()=>o,fh:()=>v,gu:()=>m,sZ:()=>h,tn:()=>j,xp:()=>f});var s=n(80263),a=n(53239),r=n(51859);let i="mx-auto w-full max-w-[1200px]",l="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",o=(0,a.forwardRef)((e,t)=>{let{className:n,bottomPadding:a,size:i="default",...o}=e;return(0,s.jsx)("div",{ref:t,...o,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[i],l,a&&"pb-16",n)})}),c=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("header",{...a,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",n)})}),d=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("h1",{ref:t,...a,className:(0,r.cn)("text-2xl",n)})}),u=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("p",{ref:t,...a,className:(0,r.cn)("text-sm text-foreground-light",n)})}),m=(0,a.forwardRef)((e,t)=>{let{className:n,isFullWidth:a,topPadding:i,...l}=e;return(0,s.jsx)("div",{ref:t,...l,className:(0,r.cn)("flex flex-col first:pt-12 py-6",a?"w-full":"gap-3 lg:grid md:grid-cols-12",n)})}),x=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("w-full h-px bg-border",n)})}),h=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("h3",{ref:t,...a,className:(0,r.cn)("text-foreground text-xl",n)})}),g=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("p",{ref:t,...a,className:(0,r.cn)("text-sm text-foreground-light",n)})}),f=(0,a.forwardRef)((e,t)=>{let{className:n,children:a,title:i,...l}=e;return(0,s.jsxs)("div",{ref:t,...l,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",n),children:[i&&(0,s.jsx)("h2",{children:i}),a]})}),p=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",n)})}),j=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-col gap-3 items-center",n)})}),y=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex w-full items-center",n)})}),v=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-row gap-3",n)})}),b=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",n)})}),N=(0,a.forwardRef)((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,r.cn)(i,l,"my-8 flex flex-col gap-8",n)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",o.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",b.displayName="ScaffoldColumn",f.displayName="ScaffoldSectionDetail",p.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",y.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",h.displayName="ScaffoldSectionTitle",g.displayName="ScaffoldSectionDescription"},43970:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,b:()=>d});var s=n(80263),a=n(53239),r=n(67920),i=n(71126),l=n(70324),o=n(82008),c=n(55866);let d=e=>{let{visible:t,onClose:n}=e;return(0,s.jsx)(r.A,{size:"medium",visible:t,header:"Schemas managed by Supabase",customFooter:(0,s.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,s.jsx)(i.$,{type:"default",onClick:()=>n(),children:"Understood"})}),onCancel:()=>n(),"data-sentry-element":"Modal","data-sentry-component":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,s.jsxs)(r.A.Content,{className:"space-y-2","data-sentry-element":"unknown","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,s.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:o.i.map(e=>(0,s.jsx)("code",{className:"text-xs",children:e},e))}),(0,s.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,s.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]})})},u=e=>{let{schema:t,entity:n}=e,[r,o]=(0,a.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Fc,{"data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,s.jsx)(c.A,{strokeWidth:2,"data-sentry-element":"AlertCircle","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,s.jsxs)(l.XL,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:["Currently viewing ",n," from a protected schema"]}),(0,s.jsxs)(l.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,s.jsxs)("p",{className:"mb-2",children:["The ",(0,s.jsx)("code",{className:"text-xs",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,s.jsx)(i.$,{type:"default",size:"tiny",onClick:()=>o(!0),"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Learn more"})]})]}),(0,s.jsx)(d,{visible:r,onClose:()=>o(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx"})]})}},45388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>e2});var s=n(80263),a=n(60045),r=n(53239),i=n(90915),l=n(73969),o=n(97872),c=n(83117),d=n(87304);let u=e=>{let{trigger:t,visible:n,setVisible:a}=e,{project:r}=(0,o.Om)(),{name:i,schema:u}=null!=t?t:{},{mutate:m,isLoading:x}=(0,c.R)();async function h(){return r?t?void m({projectRef:r.ref,connectionString:r.connectionString,trigger:t},{onSuccess:()=>{l.oR.success("Successfully removed ".concat(i)),a(!1)}}):console.error("Trigger ID is required"):console.error("Project is required")}return(0,s.jsx)(d.A,{variant:"warning",visible:n,onCancel:()=>a(!n),onConfirm:h,title:"Delete this trigger",loading:x,confirmLabel:"Delete trigger ".concat(i),confirmPlaceholder:"Type in name of trigger",confirmString:null!=i?i:"",text:(0,s.jsxs)(s.Fragment,{children:["This will delete your trigger called"," ",(0,s.jsx)("span",{className:"text-bold text-foreground",children:i})," of schema"," ",(0,s.jsx)("span",{className:"text-bold text-foreground",children:u})]}),alert:{title:"You cannot recover this trigger once deleted."},"data-sentry-element":"TextConfirmModal","data-sentry-component":"DeleteTrigger","data-sentry-source-file":"DeleteTrigger.tsx"})};var m=n(32981),x=n(97689),h=n(87494),g=n(39353);let f=e=>{let{icon:t,text:n}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-center flex-row py-4 space-x-2","data-sentry-component":"FormBoxEmpty","data-sentry-source-file":"FormBoxEmpty.tsx",children:[(0,s.jsx)("div",{className:"relative bg-surface-100 text-foreground-lighter w-6 h-6 rounded-full flex items-center justify-center",children:t}),(0,s.jsx)("p",{className:"text-foreground-light",children:n})]})};var p=n(68280),j=n(32144),y=n(80251),v=n(45874),b=n(49389),N=n(96557);async function w(e){let{originalTrigger:t,projectRef:n,connectionString:s,payload:a}=e,{sql:r}=v.A.triggers.update(t,a),{result:i}=await (0,N.E)({projectRef:n,connectionString:s,sql:r,queryKey:["trigger","update",t.id]});return i}let _=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,j.jE)();return(0,y.n)(e=>w(e),{async onSuccess(t,n,a){let{projectRef:r}=n;await s.invalidateQueries(b.U.list(r)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?l.oR.error("Failed to update database trigger: ".concat(e.message)):t(e,n,s)},...n})};var S=n(61607),A=n(68875),C=n(82008),E=n(14943),q=n(57980),T=n(24794),k=n(20894),F=n(22979),R=n(9093),I=n(51859),M=n(71126),L=n(84377),P=n(17611),z=n(19898),D=n(76803),$=n.n(D),W=n(86727),O=n.n(W),B=n(59153),V=n.n(B),G=n(47504),Y=n(35212),H=n(46610),U=n(72256),Q=n(59344),J=n(38543),K=n(87959),X=n(62659);let Z=e=>{let{visible:t,onChange:n,setVisible:a}=e,r=(0,A.KT)(),{data:i=[]}=(0,J.e)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString}),l=i.filter(e=>"trigger"===e.return_type),o=l.length>=1,c=$()(O()(l,"schema"),"schema"),d=e=>{let s=l.find(t=>t.id===e);s&&n(s),a(!t)};return(0,s.jsx)(Y.Ay,{size:"large",header:"Pick a function",visible:t,onCancel:()=>a(!t),className:"hooks-sidepanel","data-sentry-element":"SidePanel","data-sentry-component":"ChooseFunctionForm","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,s.jsx)("div",{className:"py-6",children:o?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(ee,{}),c.map(e=>(0,s.jsx)(en,{schema:e,functions:l.filter(t=>t.schema==e),selectFunction:d},e))]}):(0,s.jsx)(et,{})})})},ee=()=>{let{ref:e}=(0,z.g)();return(0,s.jsx)("div",{className:"px-6","data-sentry-component":"NoticeBox","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,s.jsx)(U.A,{icon:(0,s.jsx)(K.A,{size:"20",strokeWidth:1.5}),title:"Only functions that return a trigger will be displayed below",description:"You can make functions by using the Database Functions",button:(0,s.jsx)(M.$,{asChild:!0,type:"default",children:(0,s.jsx)(V(),{href:"/project/".concat(e,"/database/functions"),children:"Go to Functions"})}),"data-sentry-element":"InformationBox","data-sentry-source-file":"ChooseFunctionForm.tsx"})})},et=()=>{let e=(0,G.useRouter)(),{ref:t}=e.query;return(0,s.jsx)(H.A,{title:"No Trigger Functions found in database",ctaButtonLabel:"Create a trigger function",onClickCta:()=>{e.push("/project/".concat(t,"/database/functions"))},"data-sentry-element":"ProductEmptyState","data-sentry-component":"NoFunctionsState","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You will need to create a trigger based function before you can add it to your trigger."})})},en=e=>{let{schema:t,functions:n,selectFunction:a}=e;return(0,s.jsxs)("div",{className:"space-y-4","data-sentry-component":"SchemaFunctionGroup","data-sentry-source-file":"ChooseFunctionForm.tsx",children:[(0,s.jsxs)("div",{className:"sticky top-0 flex items-center space-x-1 px-6 backdrop-blur backdrop-filter",children:[(0,s.jsx)("h5",{className:"text-foreground-light",children:"schema"}),(0,s.jsx)("h5",{children:t})]}),(0,s.jsx)("div",{className:"space-y-0 divide-y border-t border-b border-default",children:n.map(e=>(0,s.jsx)(es,{id:e.id,completeStatement:e.complete_statement,name:e.name,onClick:a},e.id))})]})},es=e=>{let{id:t,completeStatement:n,name:a,onClick:i}=e,[l,o]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"cursor-pointer rounded p-3 px-6 hover:bg-studio",onClick:()=>i(t),"data-sentry-component":"Function","data-sentry-source-file":"ChooseFunctionForm.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center rounded bg-foreground p-1 text-background",children:(0,s.jsx)(x.A,{strokeWidth:2,size:14,"data-sentry-element":"Terminal","data-sentry-source-file":"ChooseFunctionForm.tsx"})}),(0,s.jsx)("p",{className:"mb-0 text-sm",children:a})]}),(0,s.jsx)(M.$,{type:"text",onClick:e=>{e.stopPropagation(),o(!l)},icon:(0,s.jsx)(X.A,{className:l?"rotate-180 transform":"rotate-0 transform"}),"data-sentry-element":"Button","data-sentry-source-file":"ChooseFunctionForm.tsx",children:l?"Hide definition":"View definition"})]}),(0,s.jsx)(P.e,{show:l,enter:"transition ease-out duration-300",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0","data-sentry-element":"Transition","data-sentry-source-file":"ChooseFunctionForm.tsx",children:(0,s.jsx)("div",{className:"mt-4 h-64 border border-default",children:(0,s.jsx)(Q.A,{defaultValue:n,readOnly:!0,contextmenu:!1,"data-sentry-element":"SqlEditor","data-sentry-source-file":"ChooseFunctionForm.tsx"})})})]})},ea=[{value:"INSERT",label:"Insert",description:"Any insert operation on the table"},{value:"UPDATE",label:"Update",description:"Any update operation of any column on the table"},{value:"DELETE",label:"Delete",description:"Any delete operation of a record"}],er=[{value:"BEFORE",label:"Before the event",description:"Trigger fires before the operation is attempted"},{value:"AFTER",label:"After the event",description:"Trigger fires before the operation has completed"}],ei=[{value:"ROW",label:"Row",description:"Fires once for each processed row"},{value:"STATEMENT",label:"Statement",description:"Fires once for each statement"}],el=[{value:"ORIGIN",label:"Origin",description:"This is the default behaviour"},{value:"REPLICA",label:"Replica",description:'Will only fire if the session is in "replica" mode'},{value:"ALWAYS",label:"Always",description:"Will fire regardless of the replication role"},{value:"DISABLED",label:"Disabled",description:"Will not fire"}],eo="create-trigger",ec=g.Ik({name:g.Yj().min(1,"Please provide a name for your trigger").regex(/^\S+$/,"Name should not contain spaces or whitespaces"),schema:g.Yj(),table:g.Yj(),activation:g.k5(["BEFORE","AFTER","INSTEAD OF"]),enabled_mode:g.k5(["ORIGIN","REPLICA","ALWAYS","DISABLED"]),orientation:g.k5(["ROW","STATEMENT"]),function_name:g.Yj().min(1,"Please select a database function for your trigger to call"),function_schema:g.Yj(),events:g.YO(g.Yj()).min(1,"Please select at least one event"),tableId:g.Yj().optional()}),ed={name:"",schema:"",table:"",activation:"AFTER",orientation:"ROW",function_name:"",function_schema:"",enabled_mode:"ORIGIN",events:[]},eu=e=>{let{selectedTrigger:t,open:n,setOpen:a}=e,i=(0,A.KT)(),[o,c]=(0,r.useState)(!1),{mutate:d,isLoading:u}=(0,p.Y)({onSuccess:e=>{l.oR.success("Successfully created trigger ".concat(e.name)),a(!1)},onError:e=>{l.oR.error("Failed to create trigger: ".concat(e.message))}}),{mutate:g,isLoading:j}=_({onSuccess:e=>{l.oR.success("Successfully updated trigger ".concat(e.name)),a(!1)},onError:e=>{l.oR.error("Failed to update trigger: ".concat(e.message))}}),{data:y=[],isSuccess:v}=(0,S.LW)({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString}),b=y.sort((e,t)=>e.schema.localeCompare(t.schema)).filter(e=>!C.i.includes(e.schema)),N=!!t,w=(0,h.mN)({mode:"onSubmit",reValidateMode:"onSubmit",resolver:(0,m.u)(ec),defaultValues:ed}),{function_name:P,function_schema:z}=w.watch(),D=async e=>{if(!i)return console.error("Project is required");let{tableId:n,...s}=e;N?g({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,originalTrigger:t,payload:{name:s.name,enabled_mode:s.enabled_mode}}):d({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,payload:s})};return(0,r.useEffect)(()=>{n&&v&&(w.clearErrors(),N?w.reset(t):b.length>0&&w.reset({...ed,tableId:b[0].id.toString(),table:b[0].name,schema:b[0].schema}))},[n,v]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.cj,{open:n,onOpenChange:a,"data-sentry-element":"Sheet","data-sentry-source-file":"TriggerSheet.tsx",children:(0,s.jsxs)(E.h,{size:"lg",className:"flex flex-col gap-0","data-sentry-element":"SheetContent","data-sentry-source-file":"TriggerSheet.tsx",children:[(0,s.jsx)(E.Fm,{"data-sentry-element":"SheetHeader","data-sentry-source-file":"TriggerSheet.tsx",children:(0,s.jsx)(E.qp,{"data-sentry-element":"SheetTitle","data-sentry-source-file":"TriggerSheet.tsx",children:N?"Edit database trigger: ".concat(t.name):"Create a new database trigger"})}),(0,s.jsx)(q.lV,{...w,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"TriggerSheet.tsx",children:(0,s.jsxs)("form",{id:eo,className:"flex-1 flex flex-col gap-y-6 overflow-auto py-6",onSubmit:w.handleSubmit(D),children:[(0,s.jsx)(q.zB,{name:"name",control:w.control,render:e=>{let{field:t}=e;return(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Name of trigger",description:"Do not use spaces/whitespace.",children:(0,s.jsx)(q.MJ,{children:(0,s.jsx)(T.p,{...t,placeholder:"Name of trigger"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"TriggerSheet.tsx"}),N?(0,s.jsx)(q.zB,{name:"enabled_mode",control:w.control,render:e=>{var t;let{field:n}=e;return(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Enabled mode",description:"Determines if a trigger should or should not fire. Can also be used to disable a trigger, but not delete it.",children:(0,s.jsx)(q.MJ,{children:(0,s.jsxs)(k.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,s.jsx)(k.bq,{className:"col-span-8",children:null==(t=el.find(e=>e.value===n.value))?void 0:t.label}),(0,s.jsx)(k.gC,{children:el.map(e=>(0,s.jsxs)(k.eb,{value:e.value,children:[(0,s.jsx)("p",{className:"text-foreground",children:e.label}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.w,{}),(0,s.jsx)(q.zB,{name:"tableId",control:w.control,render:e=>{let{field:t}=e;return(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Table",description:"Trigger will watch for changes on this table",children:(0,s.jsx)(q.MJ,{children:(0,s.jsxs)(k.l6,{defaultValue:t.value,onValueChange:e=>{let t=b.find(t=>t.id.toString()===e);t&&(w.setValue("table",t.name),w.setValue("schema",t.schema))},children:[(0,s.jsx)(k.bq,{className:"col-span-8",children:(0,s.jsx)(k.yv,{})}),(0,s.jsx)(k.gC,{children:b.map(e=>(0,s.jsxs)(k.eb,{value:e.id.toString(),children:[(0,s.jsxs)("span",{className:"text-foreground-light",children:[e.schema,"."]}),(0,s.jsx)("span",{className:"text-foreground",children:e.name})]},e.id))})]})})})}}),(0,s.jsx)(q.zB,{name:"events",control:w.control,render:()=>(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Events",description:"These are the events that are watched by the trigger, only the events selected above will fire the trigger on the table you've selected.",children:ea.map(e=>(0,s.jsx)(q.zB,{control:w.control,name:"events",render:t=>{var n;let{field:a}=t;return(0,s.jsx)(L.M,{hideMessage:!0,layout:"flex",label:e.label,description:e.description,children:(0,s.jsx)(q.MJ,{children:(0,s.jsx)(R.S,{className:"translate-y-[2px]",checked:null==(n=a.value)?void 0:n.includes(e.value),onCheckedChange:t=>{var n;return t?a.onChange([...a.value,e.value]):a.onChange(null==(n=a.value)?void 0:n.filter(t=>t!==e.value))}})})})}},e.value))})}),(0,s.jsx)(q.zB,{name:"activation",control:w.control,render:e=>{var t;let{field:n}=e;return(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Trigger type",description:"Determines when your trigger fires",children:(0,s.jsx)(q.MJ,{children:(0,s.jsxs)(k.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,s.jsx)(k.bq,{className:"col-span-8",children:null==(t=er.find(e=>e.value===n.value))?void 0:t.label}),(0,s.jsx)(k.gC,{children:er.map(e=>(0,s.jsxs)(k.eb,{value:e.value,children:[(0,s.jsx)("p",{className:"text-foreground",children:e.label}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}),(0,s.jsx)(q.zB,{name:"orientation",control:w.control,render:e=>{var t;let{field:n}=e;return(0,s.jsx)(L.M,{className:"px-5",layout:"horizontal",label:"Orientation",description:"Identifies whether the trigger fires once for each processed row or once for each statement",children:(0,s.jsx)(q.MJ,{children:(0,s.jsxs)(k.l6,{defaultValue:n.value,onValueChange:n.onChange,children:[(0,s.jsx)(k.bq,{className:"col-span-8",children:null==(t=ei.find(e=>e.value===n.value))?void 0:t.label}),(0,s.jsx)(k.gC,{children:ei.map(e=>(0,s.jsxs)(k.eb,{value:e.value,children:[(0,s.jsx)("p",{className:"text-foreground",children:e.label}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.value))})]})})})}}),(0,s.jsx)(F.w,{}),(0,s.jsx)(q.zB,{name:"function_name",control:w.control,render:()=>(0,s.jsx)(L.M,{layout:"vertical",className:"px-5",children:(0,s.jsx)(q.MJ,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-smn",children:"Function to trigger"}),0===P.length?(0,s.jsx)("button",{type:"button",className:(0,I.cn)("relative w-full rounded border border-default","bg-surface-200 px-5 py-1 shadow-sm transition-all","hover:border-strong hover:bg-overlay-hover"),onClick:()=>c(!0),children:(0,s.jsx)(f,{icon:(0,s.jsx)(x.A,{size:14,strokeWidth:2}),text:"Choose a function to trigger"})}):(0,s.jsxs)("div",{className:(0,I.cn)("relative w-full flex items-center justify-between","space-x-3 px-5 py-4 border border-default","rounded shadow-sm transition-shadow"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded bg-foreground text-background focus-within:bg-opacity-10",children:(0,s.jsx)(x.A,{size:"18",strokeWidth:2,width:14})}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-sm text-foreground-light",children:z}),".",(0,s.jsx)("span",{className:"text-sm text-foreground",children:P})]})]}),(0,s.jsx)(M.$,{type:"default",onClick:()=>c(!0),children:"Change function"})]})]})})})})]})]})}),(0,s.jsxs)(E.XW,{className:"shrink-0","data-sentry-element":"SheetFooter","data-sentry-source-file":"TriggerSheet.tsx",children:[(0,s.jsx)(M.$,{type:"default",htmlType:"reset",disabled:u||j,onClick:()=>a(!1),"data-sentry-element":"Button","data-sentry-source-file":"TriggerSheet.tsx",children:"Cancel"}),(0,s.jsx)(M.$,{form:eo,htmlType:"submit",loading:u||j,"data-sentry-element":"Button","data-sentry-source-file":"TriggerSheet.tsx",children:"Create trigger"})]})]})}),(0,s.jsx)(Z,{visible:o,setVisible:c,onChange:e=>{w.setValue("function_name",e.name),w.setValue("function_schema",e.schema)},"data-sentry-element":"ChooseFunctionForm","data-sentry-source-file":"TriggerSheet.tsx"})]})},em=e=>{let t=e.events.join(" OR "),n=e.function_args.length>0?"(".concat(e.function_args.join(", "),")"):"()",s='\nDROP TRIGGER IF EXISTS "'.concat(e.name,'" ON "').concat(e.schema,'"."').concat(e.table,'";\n\nCREATE TRIGGER "').concat(e.name,'"\n').concat(e.activation," ").concat(t,'\nON "').concat(e.schema,'"."').concat(e.table,'"\nFOR EACH ').concat(e.orientation,"\n");return e.condition&&(s+="WHEN (".concat(e.condition,")\n")),(s+='EXECUTE FUNCTION "'.concat(e.function_schema,'"."').concat(e.function_name,'"').concat(n,";")).trim()};var ex=n(83927),eh=n.n(ex),eg=n(53667),ef=n.n(eg),ep=n(95285),ej=n(66345),ey=n(66644);let ev=()=>(0,s.jsx)(ey.F,{title:"Alpha preview",withIcon:!0,variant:"warning","data-sentry-element":"Alert","data-sentry-component":"AlphaPreview","data-sentry-source-file":"AlphaPreview.tsx",children:"This is not suitable for production"});var eb=n(80125),eN=n(48153),ew=n(41370),e_=n(4487),eS=n(96457),eA=n(12091),eC=n(788),eE=n(77227),eq=n(25321),eT=n(89634),ek=n(16988),eF=n(83026),eR=n(43970),eI=n(86926),eM=n.n(eI),eL=n(14506),eP=n.n(eL),ez=n(44679),eD=n(62763),e$=n(1051),eW=n(69368),eO=n(15576),eB=n(28097),eV=n(16632),eG=n(65863),eY=n(74115);let eH=e=>{let{schema:t,filterString:n,isLocked:r,editTrigger:i,deleteTrigger:l}=e,{project:c}=(0,o.Om)(),d=(0,eT.xd)(),{data:u}=(0,eA.oR)({projectRef:null==c?void 0:c.ref,connectionString:null==c?void 0:c.connectionString}),m=(null!=u?u:[]).filter(e=>eM()(e.name.toLowerCase(),n.toLowerCase())),x=eP()(m.filter(e=>e.schema==t),e=>e.name.toLocaleLowerCase()),h=(0,eE.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"triggers");return 0===x.length&&0===n.length?(0,s.jsx)(eb.A.tr,{children:(0,s.jsxs)(eb.A.td,{colSpan:7,children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No triggers created yet"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no triggers found in the schema "',t,'"']})]})},t):0===x.length&&n.length>0?(0,s.jsx)(eb.A.tr,{children:(0,s.jsxs)(eb.A.td,{colSpan:7,children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',n,'" did not return any results']})]})},t):(0,s.jsx)(s.Fragment,{children:x.map(e=>(0,s.jsxs)(eb.A.tr,{children:[(0,s.jsx)(eb.A.td,{className:"space-x-2",children:(0,s.jsxs)(eV.m_,{children:[(0,s.jsx)(eV.k$,{onClick:()=>i(e),className:"cursor-pointer text-foreground truncate max-w-48 inline-block",children:e.name}),(0,s.jsx)(eV.ZI,{side:"bottom",align:"center",children:e.name})]})}),(0,s.jsx)(eb.A.td,{className:"break-all",children:(0,s.jsx)("p",{title:e.table,className:"truncate",children:e.table})}),(0,s.jsx)(eb.A.td,{className:"space-x-2",children:(0,s.jsx)("p",{title:e.function_name,className:"truncate",children:e.function_name})}),(0,s.jsx)(eb.A.td,{children:(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.events.map(t=>(0,s.jsx)(eG.E,{children:"".concat(e.activation," ").concat(t)},t))})}),(0,s.jsx)(eb.A.td,{className:"space-x-2",children:(0,s.jsx)("p",{title:e.orientation,className:"truncate",children:e.orientation})}),(0,s.jsx)(eb.A.td,{children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:"DISABLED"!==e.enabled_mode?(0,s.jsx)(ez.A,{strokeWidth:2,className:"text-brand"}):(0,s.jsx)(eD.A,{strokeWidth:2})})}),(0,s.jsx)(eb.A.td,{className:"text-right",children:!r&&(0,s.jsx)("div",{className:"flex items-center justify-end",children:h?(0,s.jsxs)(eY.rI,{children:[(0,s.jsx)(eY.ty,{asChild:!0,children:(0,s.jsx)(M.$,{type:"default",className:"px-1",icon:(0,s.jsx)(e$.A,{})})}),(0,s.jsxs)(eY.SQ,{side:"bottom",align:"end",className:"w-52",children:[(0,s.jsxs)(eY._2,{className:"space-x-2",onClick:()=>{em(e),i(e)},children:[(0,s.jsx)(eW.A,{size:14}),(0,s.jsx)("p",{children:"Edit trigger"})]}),(0,s.jsxs)(eY._2,{className:"space-x-2",onClick:()=>{let t=em(e);d.newChat({name:"Update trigger ".concat(eD.A.name),open:!0,initialInput:"Update this trigger which exists on the ".concat(e.schema,".").concat(e.table," table to..."),suggestions:{title:"I can help you make a change to this trigger, here are a few example prompts to get you started:",prompts:["Rename this trigger to ...","Change the events this trigger responds to ...","Modify this trigger to run after instead of before ..."]},sqlSnippets:[t]})},children:[(0,s.jsx)(eO.A,{size:14}),(0,s.jsx)("p",{children:"Edit with Assistant"})]}),(0,s.jsxs)(eY._2,{className:"space-x-2",onClick:()=>l(e),children:[(0,s.jsx)(eB.A,{stroke:"red",size:14}),(0,s.jsx)("p",{children:"Delete trigger"})]})]})]}):(0,s.jsx)(ew.G,{disabled:!0,type:"default",className:"px-1",icon:(0,s.jsx)(e$.A,{}),tooltip:{content:{side:"bottom",text:"You need additional permissions to update triggers"}}})})})]},e.id))})},eU=e=>{let{createTrigger:t=eh(),editTrigger:n=eh(),deleteTrigger:i=eh()}=e,{project:l}=(0,o.Om)(),c=(0,eT.xd)(),{selectedSchema:d,setSelectedSchema:u}=(0,eq.k)(),[m,x]=(0,r.useState)(""),{data:h}=(0,eC.w$)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),[g]=ef()(null!=h?h:[],e=>{var t;return C.i.includes(null!=(t=null==e?void 0:e.name)?t:"")}),f=null==h?void 0:h.find(e=>e.name===d),p=g.some(e=>e.id===(null==f?void 0:f.id)),{data:j=[],isSuccess:y}=(0,S.LW)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),v=j.filter(e=>!C.i.includes(e.schema)).length>0,{data:b,error:N,isLoading:w,isError:_}=(0,eA.oR)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),A=(0,eE.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"triggers");return w?(0,s.jsx)(eS.y,{}):_?(0,s.jsx)(eN.A,{error:N,subject:"Failed to retrieve database triggers"}):(0,s.jsx)(s.Fragment,{children:0===(null!=b?b:[]).length?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsxs)(H.A,{title:"Triggers",ctaButtonLabel:"Create a new trigger",onClickCta:()=>t(),children:[(0,s.jsx)(ev,{}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"A PostgreSQL trigger is a function invoked automatically whenever an event associated with a table occurs."}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"An event could be any of the following: INSERT, UPDATE, DELETE. A trigger is a special user-defined function associated with a table."})]})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-2 flex-wrap",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[(0,s.jsx)(e_.A,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:d,onSelectSchema:u}),(0,s.jsx)(ek.A,{placeholder:"Search for a trigger",size:"tiny",icon:(0,s.jsx)(ep.A,{size:"14"}),value:m,className:"w-full lg:w-52",onChange:e=>x(e.target.value)})]}),!p&&(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(ew.G,{disabled:!v||!A,icon:(0,s.jsx)(ej.A,{}),onClick:()=>t(),className:"flex-grow",tooltip:{content:{side:"bottom",text:v?A?void 0:"You need additional permissions to create triggers":"Create a table first before creating triggers"}},children:"New trigger"}),v&&(0,s.jsx)(ew.G,{type:"default",disabled:!v||!A,className:"px-1 pointer-events-auto",icon:(0,s.jsx)(eF.M,{size:16}),onClick:()=>c.newChat({name:"Create new trigger",open:!0,initialInput:"Create a new trigger for the schema ".concat(d," that does ..."),suggestions:{title:"I can help you create a new trigger, here are a few example prompts to get you started:",prompts:["Create a trigger that logs changes to the users table","Create a trigger that updates updated_at timestamp","Create a trigger that validates email format before insert"]}}),tooltip:{content:{side:"bottom",text:A?"Create with Supabase Assistant":"You need additional permissions to create triggers"}}})]})]}),p&&(0,s.jsx)(eR.A,{schema:d,entity:"triggers"}),(0,s.jsx)("div",{className:"w-full overflow-hidden overflow-x-auto",children:(0,s.jsx)(eb.A,{head:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eb.A.th,{children:"Name"},"name"),(0,s.jsx)(eb.A.th,{children:"Table"},"table"),(0,s.jsx)(eb.A.th,{children:"Function"},"function"),(0,s.jsx)(eb.A.th,{children:"Events"},"events"),(0,s.jsx)(eb.A.th,{children:"Orientation"},"orientation"),(0,s.jsx)(eb.A.th,{className:"w-20",children:"Enabled"},"enabled"),(0,s.jsx)(eb.A.th,{className:"w-1/12"},"buttons")]}),body:(0,s.jsx)(eH,{schema:d,filterString:m,isLocked:p,editTrigger:n,deleteTrigger:i})})})]})})};var eQ=n(25549),eJ=n(1053),eK=n(40402),eX=n(76448),eZ=n(10585),e0=n(22787);let e1=()=>{let{setEditorPanel:e}=(0,e0.qM)(),t=(0,i.h4)(),[n,l]=(0,r.useState)(),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),x=(0,eE.SE)(a.aG.TENANT_SQL_ADMIN_READ,"triggers");return(0,eE.Lh)()&&!x?(0,s.jsx)(eZ.A,{isFullPage:!0,resourceText:"view database triggers"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eK.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"triggers.tsx",children:(0,s.jsx)(eK.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"triggers.tsx",children:(0,s.jsxs)("div",{className:"col-span-12",children:[(0,s.jsx)(eX.M,{title:"Database Triggers",description:"Execute a set of actions automatically on specified table events",docsUrl:"https://supabase.com/docs/guides/database/postgres/triggers","data-sentry-element":"FormHeader","data-sentry-source-file":"triggers.tsx"}),(0,s.jsx)(eU,{createTrigger:()=>{t?e({open:!0,initialValue:"create trigger trigger_name\nafter insert or update or delete on table_name\nfor each row\nexecute function function_name();",label:"Create new database trigger",saveLabel:"Create trigger",initialPrompt:"Create a new database trigger that..."}):(l(void 0),c(!0))},editTrigger:n=>{t?e({open:!0,initialValue:em(n),label:'Edit trigger "'.concat(n.name,'"'),saveLabel:"Update trigger",initialPrompt:'Update the database trigger "'.concat(n.name,'" to...')}):(l(n),c(!0))},deleteTrigger:e=>{l(e),m(!0)},"data-sentry-element":"TriggersList","data-sentry-source-file":"triggers.tsx"})]})})}),(0,s.jsx)(eu,{selectedTrigger:n,open:o,setOpen:c,"data-sentry-element":"TriggerSheet","data-sentry-source-file":"triggers.tsx"}),(0,s.jsx)(u,{trigger:n,visible:d,setVisible:m,"data-sentry-element":"DeleteTrigger","data-sentry-source-file":"triggers.tsx"})]})};e1.getLayout=e=>(0,s.jsx)(eJ.A,{children:(0,s.jsx)(eQ.A,{title:"Database",children:e})});let e2=e1},45942:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});let s={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,t,n)=>["projects",e,"queue-messages",t,n].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,t)=>["projects",e,"queue-metrics",t],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},46610:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var s=n(80263),a=n(77877),r=n(41370),i=n(59153),l=n.n(i),o=n(71126);let c=e=>{let{title:t="",size:n="medium",children:i,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:x=!1,disabled:h=!1,disabledMessage:g="",ctaUrl:f}=e,p=c&&m||u&&d;return(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,s.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,s.jsx)("h5",{className:"text-foreground",children:t}),(0,s.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:i}),p&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&f?(0,s.jsx)(o.$,{asChild:!0,type:"primary",children:(0,s.jsx)(l(),{href:f,children:c})}):c&&m?(0,s.jsx)(r.G,{type:"primary",onClick:m,loading:x,disabled:x||h,tooltip:{content:{side:"bottom",text:h&&g.length>0?g:void 0}},children:c}):null,u&&d?(0,s.jsx)(o.$,{type:"default",icon:(0,s.jsx)(a.A,{strokeWidth:1.5}),children:(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},59344:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var s=n(80263),a=n(14360),r=n(83927),i=n.n(r),l=n(53239),o=n(97872),c=n(17271);let d=e=>{let{queryId:t,language:n="pgsql",defaultValue:r="",readOnly:d=!1,contextmenu:u=!0,onInputChange:m=i()}=e,x=(0,a.useMonaco)(),{project:h}=(0,o.Om)(),g=(0,l.useRef)();return(0,l.useEffect)(()=>{if(x){let e=x.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),n=(0,c.A)(t);return[{range:e.getFullModelRange(),text:n}]}});return()=>{e.dispose()}}},[x]),(0,l.useEffect)(()=>{if(g.current){var e;null==(e=g.current)||e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})}},[t]),(0,s.jsx)(a.default,{className:"monaco-editor",theme:"supabase",defaultLanguage:n,defaultValue:r,path:t,loading:(0,s.jsx)(()=>(0,s.jsx)("h4",{className:"text-lg","data-sentry-component":"Loading","data-sentry-source-file":"SqlEditor.tsx",children:"Loading"}),{}),options:{readOnly:d,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:u},onMount:(e,t)=>{g.current=e,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})},onChange:m,"data-sentry-element":"Editor","data-sentry-component":"SqlEditor","data-sentry-source-file":"SqlEditor.tsx"})}},66644:(e,t,n)=>{"use strict";n.d(t,{F:()=>m});var s=n(80263),a=n(53239),r=n(16865),i=n(92287),l=n(38627),o=n(74438),c=n(3073),d=n(62763);let u={danger:(0,s.jsx)(i.A,{strokeWidth:1.5,size:18}),success:(0,s.jsx)(l.A,{strokeWidth:1.5,size:18}),warning:(0,s.jsx)(o.A,{strokeWidth:1.5,size:18}),info:(0,s.jsx)(c.A,{strokeWidth:1.5,size:18}),neutral:(0,s.jsx)(s.Fragment,{})};function m(e){let{variant:t="neutral",className:n,title:i,withIcon:l,closable:o,children:c,icon:m,actions:x}=e,h=(0,r.A)("alert"),[g,f]=(0,a.useState)(!0),p=[h.base];p.push(h.variant[t].base),n&&p.push(n);let j=[h.description,h.variant[t].description],y=[h.close];return(0,s.jsx)(s.Fragment,{children:g&&(0,s.jsxs)("div",{className:p.join(" "),children:[l?(0,s.jsx)("div",{className:h.variant[t].icon,children:l&&u[t]}):null,m&&m,(0,s.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:[h.variant[t].header,h.header].join(" "),children:i}),(0,s.jsx)("div",{className:j.join(" "),children:c})]}),x]}),o&&(0,s.jsx)("button",{"aria-label":"Close alert",onClick:()=>f(!1),className:y.join(" "),children:(0,s.jsx)(d.A,{strokeWidth:2,size:16})})]})})}},68280:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d});var s=n(32144),a=n(80251),r=n(73969),i=n(45874),l=n(49389),o=n(96557);async function c(e){let{projectRef:t,connectionString:n,payload:s}=e,{sql:a}=i.A.triggers.create(s),{result:r}=await (0,o.E)({projectRef:t,connectionString:n,sql:a,queryKey:["trigger","create"]});return r}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,s.jE)();return(0,a.n)(e=>c(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await i.invalidateQueries(l.U.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?r.oR.error("Failed to create database trigger: ".concat(e.message)):t(e,n,s)},...n})}},72256:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(80263),a=n(41226),r=n(52700),i=n(77877),l=n(59153),o=n.n(l),c=n(53239),d=n(71126);let u=(0,c.forwardRef)((e,t)=>{let{icon:n,title:l,description:u,url:m,urlLabel:x="Read more",defaultVisibility:h=!1,hideCollapse:g=!1,button:f,className:p="",block:j=!1}=e,[y,v]=(0,c.useState)(h);return(0,s.jsx)("div",{ref:t,role:"alert",className:"".concat(j?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(p),children:(0,s.jsxs)("div",{className:"flex flex-col px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[n&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:n}),(0,s.jsx)("div",{className:"flex-grow",children:(0,s.jsx)("h5",{className:"text-sm text-foreground",children:l})})]}),u&&!g?(0,s.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>v(!y),children:y?(0,s.jsx)(a.A,{size:14,strokeWidth:1.5}):(0,s.jsx)(r.A,{size:14,strokeWidth:1.5})}):null]}),(u||m||f)&&(0,s.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(y?"mt-3":""),style:{maxHeight:500*!!y},children:[(0,s.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,s.jsx)("div",{children:(0,s.jsx)(d.$,{asChild:!0,type:"default",icon:(0,s.jsx)(i.A,{}),children:(0,s.jsx)(o(),{href:m,target:"_blank",rel:"noreferrer",children:x})})}),f&&(0,s.jsx)("div",{children:f})]})]})})});u.displayName="InformationBox";let m=u},76448:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var s=n(80263),a=n(51859),r=n(23992);let i=e=>{let{title:t,description:n,docsUrl:i,actions:l,className:o}=e;return(0,s.jsxs)("div",{className:(0,a.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),n&&(0,s.jsx)("div",{className:"prose text-sm max-w-2xl",children:n})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==i&&(0,s.jsx)(r.A,{href:i}),l]})]})}},82008:(e,t,n)=>{"use strict";n.d(t,{Q:()=>a,i:()=>s});let s=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",n(8723).Lh],a=s.filter(e=>"extensions"!==e)},83117:(e,t,n)=>{"use strict";n.d(t,{R:()=>d});var s=n(32144),a=n(80251),r=n(73969),i=n(45874),l=n(49389),o=n(96557);async function c(e){let{trigger:t,projectRef:n,connectionString:s}=e,{sql:a}=i.A.triggers.remove(t),{result:r}=await (0,o.E)({projectRef:n,connectionString:s,sql:a,queryKey:["trigger","delete",t.id]});return r}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,s.jE)();return(0,a.n)(e=>c(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await i.invalidateQueries(l.U.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?r.oR.error("Failed to delete database trigger: ".concat(e.message)):t(e,n,s)},...n})}},89771:(e,t,n)=>{"use strict";n.d(t,{z:()=>c});var s=n(56947),a=n(40807),r=n(73516),i=n(68875),l=n(64036);async function o(e,t){let{projectRef:n,connectionString:s}=e;if(!n)throw Error("projectRef is required");let r=new Headers;s&&r.set("x-connection-encrypted",s);let{data:i,error:l}=await (0,a.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":s},path:{ref:n}},headers:r,signal:t});return l&&(0,a.H4)(l),i}let c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=(0,i.KT)(),u=(null==d?void 0:d.status)===l.BU.ACTIVE_HEALTHY;return(0,s.I)(r.I.list(t),e=>{let{signal:s}=e;return o({projectRef:t,connectionString:n},s)},{enabled:a&&void 0!==t&&u,...c})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2147,726,4669,9353,7176,3730,9844,6110,9955,6871,8153,5297,5661,4100,8870,2981,4181,2187,4560,7344,3895,1959,9116,9869,918,7872,5874,49,2174,971,6642,8434,2602,6593,636,8792],()=>t(21519)),_N_E=e.O()}]);