!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e728070f-5515-458f-bd6d-c039c253bbaf",e._sentryDebugIdIdentifier="sentry-dbid-e728070f-5515-458f-bd6d-c039c253bbaf")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937,8426],{12615:(e,t,n)=>{"use strict";n.d(t,{A:()=>L});var l=n(80263),o=n(77877),a=n(59153),i=n.n(a),r=n(73969),s=n(12862),c=n(97872),d=n(60709),u=n(32144),m=n(80251),f=n(17613),h=n(96557),g=n(81979),p=n(32036),y=n(86118),b=n(52723);async function x(e){let{projectRef:t,connectionString:n,table:l,filters:o,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var t;let{table:n,filters:l}=e,o=new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return l.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,b.b)(n,e);o=o.filter(e.column,e.operator,t)}),o.toSql()}({table:l,filters:o}),a),{result:r}=await (0,h.E)({projectRef:t,connectionString:n,sql:i,isRoleImpersonationEnabled:(0,p._c)(null==a?void 0:a.role)});return r}let v=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,u.jE)();return(0,m.n)(e=>x(e),{async onSuccess(t,n,o){let{projectRef:a,table:i}=n;await l.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,o))},async onError(e,n,l){void 0===t?r.oR.error("Failed to delete all table rows: ".concat(e.message)):t(e,n,l)},...n})};var w=n(63720),j=n(23992);async function D(e){let{projectRef:t,connectionString:n,table:l,rows:o,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var t;let{table:n,rows:l}=e,{primaryKeys:o,error:a}=(0,b.j)({table:n});if(a)throw a;let i=new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return null==o||o.forEach(e=>{let t=l.map(t=>t[e]);i=i.filter(e,"in",t)}),i.toSql()}({table:l,rows:o}),a),{result:r}=await (0,h.E)({projectRef:t,connectionString:n,sql:i,isRoleImpersonationEnabled:(0,p._c)(null==a?void 0:a.role)});return r}let C=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,u.jE)();return(0,m.n)(e=>D(e),{async onSuccess(t,n,l){let{projectRef:a,table:i}=n;await o.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,l))},async onError(e,n,o){if(void 0===t){let{table:t,rows:o}=n,a=e.message.includes("Please add a primary key column"),i=e.message.includes("violates foreign key constraint"),s=o.length>1;if(i){let n=t.name,o=e.message.split("on table ")[2].replaceAll('"',""),a=e.message.split("foreign key constraint")[1].split("on table")[0].replaceAll('"',""),i=s?"Unable to delete rows as one of them is currently referenced by a foreign key constraint from the table `".concat(o,"`."):"Unable to delete row as it is currently referenced by a foreign key constraint from the table `".concat(o,"`."),c="Set an on delete behavior on the foreign key relation `".concat(a,"` in the `").concat(o,"` table to automatically respond when row(s) are being deleted in the `").concat(n,"` table.");(0,r.oR)(i,{description:(0,l.jsx)(w.o,{content:c,className:"[&>p]:m-0"}),action:(0,l.jsx)("div",{className:"w-full flex gap-x-2 !mx-0 mt-3",children:(0,l.jsx)(j.A,{href:"https://supabase.com/docs/guides/database/postgres/cascade-deletes"})})})}else a?(0,r.oR)("Unable to delete row(s) as table has no primary keys",{description:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)(j.A,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})}):r.oR.error("Failed to delete table row: ".concat(e.message))}else t(e,n,o)},...n})};async function S(e){let{projectRef:t,connectionString:n,table:l}=e,o=function(e){var t;let{table:n}=e;return new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).truncate().toSql()}({table:l}),{result:a}=await (0,h.E)({projectRef:t,connectionString:n,sql:o});return a}let A=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,u.jE)();return(0,m.n)(e=>S(e),{async onSuccess(t,n,o){let{projectRef:a,table:i}=n;await l.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,o))},async onError(e,n,l){void 0===t?r.oR.error("Failed to truncate table row: ".concat(e.message)):t(e,n,l)},...n})};var k=n(69817),N=n(39321),E=n(65511),R=n(70324),T=n(71126),_=n(64540);let L=e=>{var t,n,a,u,m,f,h,g,y;let{selectedTable:b,onTableDeleted:x}=e,{project:w}=(0,c.Om)(),j=(0,N.ap)(),{filters:D,onApplyFilters:S}=(0,s.M)(),L=e=>{let{columnName:t}=e;S(D.filter(e=>e.column!==t))},{mutate:I}=(0,d.T)({onSuccess:()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column")return;let t=j.confirmationDialog.column;L({columnName:t.name}),r.oR.success('Successfully deleted column "'.concat(t.name,'"'))},onError:e=>{var t;if((null==(t=j.confirmationDialog)?void 0:t.type)!=="column")return;let n=j.confirmationDialog.column;r.oR.error("Failed to delete ".concat(n.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:F}=(0,k.A)({onSuccess:async()=>{r.oR.success('Successfully deleted table "'.concat(null==b?void 0:b.name,'"')),null==x||x()},onError:e=>{r.oR.error("Failed to delete ".concat(null==b?void 0:b.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:q,isLoading:M}=C({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted selected row(s)")},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:Q,isLoading:P}=v({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted selected rows")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:W,isLoading:z}=A({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted all rows from table")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),O=(null==(t=j.confirmationDialog)?void 0:t.type)==="row"&&j.confirmationDialog.allRowsSelected,H=(null==(n=j.confirmationDialog)?void 0:n.type)==="row"?j.confirmationDialog.allRowsSelected?null!=(y=j.confirmationDialog.numRows)?y:0:j.confirmationDialog.rows.length:0,X=((null==(a=j.confirmationDialog)?void 0:a.type)==="column"||(null==(u=j.confirmationDialog)?void 0:u.type)==="table")&&j.confirmationDialog.isDeleteWithCascade,$=async()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column"||void 0===w)return;let t=j.confirmationDialog.column;void 0!==t&&I({column:t,cascade:X,projectRef:w.ref,connectionString:null==w?void 0:w.connectionString})},B=async()=>{var e;(null==(e=j.confirmationDialog)?void 0:e.type)==="table"&&void 0!==b&&F({projectRef:null==w?void 0:w.ref,connectionString:null==w?void 0:w.connectionString,id:b.id,name:b.name,schema:b.schema,cascade:X})},U=(0,p.Qj)(),G=async()=>{var e;if(!w)return console.error("Project ref is required");if(!b)return console.error("Selected table required");if((null==(e=j.confirmationDialog)?void 0:e.type)!=="row")return;let t=j.confirmationDialog.rows;if(j.confirmationDialog.allRowsSelected)if(0===D.length){if(void 0!==U().role)return j.closeConfirmationDialog(),r.oR.error("Table truncation is not supported when impersonating a role");W({projectRef:w.ref,connectionString:w.connectionString,table:b})}else Q({projectRef:w.ref,connectionString:w.connectionString,table:b,filters:D,roleImpersonationState:U()});else q({projectRef:w.ref,connectionString:w.connectionString,table:b,rows:t,roleImpersonationState:U()})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(m=j.confirmationDialog)?void 0:m.type)==="column",title:'Confirm deletion of column "'.concat((null==(f=j.confirmationDialog)?void 0:f.type)==="column"&&j.confirmationDialog.column.name,'"'),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:$,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected column? This action cannot be undone."}),(0,l.jsx)(E.A,{label:"Drop column with cascade?",description:"Deletes the column and its dependent objects",checked:X,onChange:()=>j.toggleConfirmationIsWithCascade(),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),X&&(0,l.jsxs)(R.Fc,{variant:"warning",title:"Warning: Dropping with cascade may result in unintended consequences",children:[(0,l.jsx)(R.XL,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,l.jsx)(R.TN,{children:(0,l.jsx)(T.$,{asChild:!0,size:"tiny",type:"default",icon:(0,l.jsx)(o.A,{}),children:(0,l.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,l.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(h=j.confirmationDialog)?void 0:h.type)==="table",title:(0,l.jsx)("span",{className:"break-words",children:'Confirm deletion of table "'.concat(null==b?void 0:b.name,'"')}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:B,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected table? This action cannot be undone."}),(0,l.jsx)(E.A,{label:"Drop table with cascade?",description:"Deletes the table and its dependent objects",checked:X,onChange:()=>j.toggleConfirmationIsWithCascade(!X),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),X&&(0,l.jsxs)(R.Fc,{variant:"warning",children:[(0,l.jsx)(R.XL,{children:"Warning: Dropping with cascade may result in unintended consequences"}),(0,l.jsx)(R.TN,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,l.jsx)(R.TN,{className:"mt-4",children:(0,l.jsx)(T.$,{asChild:!0,size:"tiny",type:"default",icon:(0,l.jsx)(o.A,{}),children:(0,l.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,l.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(g=j.confirmationDialog)?void 0:g.type)==="row",title:(0,l.jsxs)("p",{className:"break-words",children:[(0,l.jsx)("span",{children:"Confirm to delete the selected row"}),(0,l.jsx)("span",{children:H>1&&"s"})]}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>j.closeConfirmationDialog(),onConfirm:()=>G(),loading:z||M||P,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,l.jsx)("span",{children:"Are you sure you want to delete "}),(0,l.jsxs)("span",{children:[O?"all":"the selected"," "]}),(0,l.jsx)("span",{children:H>1&&"".concat(H," ")}),(0,l.jsx)("span",{children:"row"}),(0,l.jsx)("span",{children:H>1&&"s"}),(0,l.jsx)("span",{children:"? This action cannot be undone."})]})})})]})}},13495:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var l=n(80263),o=n(60045),a=n(97872),i=n(46610),r=n(69636),s=n(77227),c=n(95319),d=n(25321),u=n(82008),m=n(39321);let f=e=>{var t,n;let{}=e,f=(0,m.ap)(),{selectedSchema:h}=(0,d.k)(),g=u.i.includes(h),p=(0,s.SE)(o.aG.TENANT_SQL_ADMIN_WRITE,"tables")&&!g,[y]=(0,c.M)("table-editor-sort","alphabetical"),{project:b}=(0,a.Om)(),{data:x}=(0,r.kD)({projectRef:null==b?void 0:b.ref,connectionString:null==b?void 0:b.connectionString,schemas:[h],sort:y}),v=null!=(n=null==x||null==(t=x.pages)?void 0:t[0].data.count)?n:0;return(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center","data-sentry-component":"EmptyState","data-sentry-source-file":"EmptyState.tsx",children:0===v?(0,l.jsx)(i.A,{title:"Table Editor",ctaButtonLabel:p?"Create a new table":void 0,onClickCta:p?f.onAddTable:void 0,children:(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"There are no tables available in this schema."})}):(0,l.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,l.jsx)(i.A,{title:"Table Editor",ctaButtonLabel:p?"Create a new table":void 0,onClickCta:p?f.onAddTable:void 0,children:(0,l.jsxs)("p",{className:"text-sm text-foreground-light",children:["Select a table from the navigation panel on the left to view its data",p&&", or create a new one."]})})})})}},26310:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/tables",function(){return n(66490)}])},26470:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});let l=(0,n(23983).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},39406:(e,t,n)=>{"use strict";n.d(t,{H:()=>l.A}),n(13495);var l=n(99599)},46610:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var l=n(80263),o=n(77877),a=n(41370),i=n(59153),r=n.n(i),s=n(71126);let c=e=>{let{title:t="",size:n="medium",children:i,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:f=!1,disabled:h=!1,disabledMessage:g="",ctaUrl:p}=e,y=c&&m||u&&d;return(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,l.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,l.jsx)("div",{className:"flex flex-col",children:(0,l.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,l.jsx)("h5",{className:"text-foreground",children:t}),(0,l.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:i}),y&&(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&p?(0,l.jsx)(s.$,{asChild:!0,type:"primary",children:(0,l.jsx)(r(),{href:p,children:c})}):c&&m?(0,l.jsx)(a.G,{type:"primary",onClick:m,loading:f,disabled:f||h,tooltip:{content:{side:"bottom",text:h&&g.length>0?g:void 0}},children:c}):null,u&&d?(0,l.jsx)(s.$,{type:"default",icon:(0,l.jsx)(o.A,{strokeWidth:1.5}),children:(0,l.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},66490:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var l=n(80263),o=n(53239),a=n(19898),i=n(95584),r=n(39406),s=n(12615),c=n(25549),d=n(1053),u=n(40402),m=n(76448),f=n(42592),h=n(39321),g=n(8246);let p=()=>{let{ref:e}=(0,a.g)(),t=(0,h.ap)(),[n,c]=(0,o.useState)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"index.tsx",children:(0,l.jsx)(u.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"index.tsx",children:(0,l.jsxs)("div",{className:"col-span-12",children:[(0,l.jsx)(m.M,{title:"Database Tables","data-sentry-element":"FormHeader","data-sentry-source-file":"index.tsx"}),(0,l.jsx)(i.B3,{onAddTable:t.onAddTable,onEditTable:e=>{c((0,f.ID)(e)),t.onEditTable()},onDeleteTable:e=>{c((0,f.ID)(e)),t.onDeleteTable()},onDuplicateTable:e=>{c((0,f.ID)(e)),t.onDuplicateTable()},"data-sentry-element":"TableList","data-sentry-source-file":"index.tsx"})]})})}),void 0!==e&&void 0!==n&&(0,f.KO)(n)&&(0,l.jsx)(g.HQ,{projectRef:e,table:n,children:(0,l.jsx)(s.A,{selectedTable:n})},"table-editor-table-".concat(n.id)),(0,l.jsx)(r.H,{includeColumns:!0,selectedTable:n,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"index.tsx"})]})};p.getLayout=e=>(0,l.jsx)(d.A,{children:(0,l.jsx)(c.A,{title:"Database",children:e})});let y=p},78777:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});let l=(0,n(23983).A)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[89,4335,2147,726,4669,9353,7176,3730,9844,6110,9955,6871,8153,5297,5661,4100,8870,2981,4181,2187,4560,7344,3895,1959,9116,9869,4938,5758,3902,7872,5874,49,2174,971,6642,8434,2602,99,6544,6206,6593,636,8792],()=>t(26310)),_N_E=e.O()}]);